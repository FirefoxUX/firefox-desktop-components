{"version":3,"file":"shopping-container-stories.b545fde5.iframe.bundle.js","mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAMA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAIA;AAIA;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;AC9JA;AACA;AACA;AACA;AACA;;AAEA;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;ACzDA;AACA;AACA;AACA;;AAEA;AAEA;;AAEA;AACA;AACA;AACA;AAEA;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAIA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;AC3HA;AACA;AACA;AACA;AACA;;AAEA;AAEA;AAEA;AAQA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;AC9EA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAIA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AAGA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;ACtJA;AACA;AACA;AACA;;AAEA;AAEA;;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;AC/CA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AAEA;;AAEA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAIA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;ACnNA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAMA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AC7MA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAIA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAKA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAEA;;;;;;;;;;;;;ACzdA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AAEA;AACA;AAEA;AAGA;AACA;AAiBA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;AC7RA;AACA;AACA;AACA;AACA;;AAEA;AAEA;;AAEA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;AC7DA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChHA;AACA;AACA;AACA;;AAEA;AACA;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;;;;;;;;;ACvEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AAEA;AAGA;AAIA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC1SA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;ACpLA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AAKA;AAQA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACpIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AAGA;AAIA;AACA;AACA;AAIA;AAGA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AA0BA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA","sources":["webpack://browser-storybook/../shopping/content/adjusted-rating.mjs","webpack://browser-storybook/../shopping/content/analysis-explainer.mjs","webpack://browser-storybook/../shopping/content/highlight-item.mjs","webpack://browser-storybook/../shopping/content/highlights.mjs","webpack://browser-storybook/../shopping/content/letter-grade.mjs","webpack://browser-storybook/../shopping/content/recommended-ad.mjs","webpack://browser-storybook/../shopping/content/reliability.mjs","webpack://browser-storybook/../shopping/content/settings.mjs","webpack://browser-storybook/../shopping/content/shopping-card.mjs","webpack://browser-storybook/../shopping/content/shopping-container.mjs","webpack://browser-storybook/../shopping/content/shopping-message-bar.mjs","webpack://browser-storybook/../shopping/content/unanalyzed.mjs","webpack://browser-storybook/../../../toolkit/content/widgets/moz-button/moz-button.mjs","webpack://browser-storybook/../../../toolkit/content/widgets/moz-five-star/moz-five-star.mjs","webpack://browser-storybook/../../../toolkit/content/widgets/moz-label/moz-label.mjs","webpack://browser-storybook/../../../toolkit/content/widgets/moz-message-bar/moz-message-bar.mjs","webpack://browser-storybook/../../../toolkit/content/widgets/moz-support-link/moz-support-link.mjs","webpack://browser-storybook/../../../toolkit/content/widgets/moz-toggle/moz-toggle.mjs","webpack://browser-storybook/./stories/shopping-container.stories.mjs"],"sourcesContent":["/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-five-star.mjs\";\n\n/**\n * Class for displaying the adjusted ratings for a given product.\n */\nclass AdjustedRating extends MozLitElement {\n  static properties = {\n    rating: { type: Number, reflect: true },\n  };\n\n  static get queries() {\n    return {\n      ratingEl: \"moz-five-star\",\n    };\n  }\n\n  render() {\n    if (!this.rating && this.rating !== 0) {\n      this.hidden = true;\n      return null;\n    }\n\n    this.hidden = false;\n\n    return html`\n      <shopping-card\n        data-l10n-id=\"shopping-adjusted-rating-label\"\n        data-l10n-attrs=\"label\"\n      >\n        <moz-five-star\n          slot=\"rating\"\n          rating=\"${this.rating === 0 ? 0.5 : this.rating}\"\n        ></moz-five-star>\n        <div slot=\"content\">\n          <span\n            data-l10n-id=\"shopping-adjusted-rating-unreliable-reviews\"\n          ></span>\n        </div>\n      </shopping-card>\n    `;\n  }\n}\n\ncustomElements.define(\"adjusted-rating\", AdjustedRating);\n","import __chrome_styles_loader__analysisexplainerStyles from \"browser/components/shopping/content/analysis-explainer.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/shopping-card.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/letter-grade.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-support-link.mjs\";\n\nconst VALID_EXPLAINER_L10N_IDS = new Map([\n  [\"reliable\", \"shopping-analysis-explainer-review-grading-scale-reliable\"],\n  [\"mixed\", \"shopping-analysis-explainer-review-grading-scale-mixed\"],\n  [\"unreliable\", \"shopping-analysis-explainer-review-grading-scale-unreliable\"],\n]);\n\n/**\n * Class for displaying details about letter grades, adjusted rating, and highlights.\n */\nclass AnalysisExplainer extends MozLitElement {\n  static properties = {\n    productUrl: { type: String, reflect: true },\n  };\n\n  static get queries() {\n    return {\n      reviewQualityExplainerLink: \"#review-quality-url\",\n    };\n  }\n\n  getGradesDescriptionTemplate() {\n    return html`\n      <section id=\"analysis-explainer-grades-wrapper\">\n        <p data-l10n-id=\"shopping-analysis-explainer-grades-intro\"></p>\n      </section>\n    `;\n  }\n\n  createGradingScaleEntry(letters, descriptionL10nId) {\n    let letterGradesTemplate = [];\n    for (let letter of letters) {\n      letterGradesTemplate.push(\n        html`<letter-grade letter=${letter}></letter-grade>`\n      );\n    }\n    return html`\n      <div class=\"analysis-explainer-grading-scale-entry\">\n        <dt class=\"analysis-explainer-grading-scale-term\">\n          <span class=\"analysis-explainer-grading-scale-letters\">\n            ${letterGradesTemplate}\n          </span>\n        </dt>\n        <dd\n          class=\"analysis-explainer-grading-scale-description\"\n          data-l10n-id=${descriptionL10nId}\n        ></dd>\n      </div>\n    `;\n  }\n\n  getGradingScaleListTemplate() {\n    return html`\n      <section id=\"analysis-explainer-grading-scale-wrapper\">\n        <dl id=\"analysis-explainer-grading-scale-list\">\n          ${this.createGradingScaleEntry(\n            [\"A\", \"B\"],\n            VALID_EXPLAINER_L10N_IDS.get(\"reliable\")\n          )}\n          ${this.createGradingScaleEntry(\n            [\"C\"],\n            VALID_EXPLAINER_L10N_IDS.get(\"mixed\")\n          )}\n          ${this.createGradingScaleEntry(\n            [\"D\", \"F\"],\n            VALID_EXPLAINER_L10N_IDS.get(\"unreliable\")\n          )}\n        </dl>\n      </section>\n    `;\n  }\n\n  // It turns out we must always return a non-empty string: if not, the fluent\n  // resolver will complain that the variable value is missing. We use the\n  // placeholder \"retailer\", which should never be visible to users.\n  getRetailerDisplayName() {\n    let defaultName = \"retailer\";\n    if (!this.productUrl) {\n      return defaultName;\n    }\n    let url = new URL(this.productUrl);\n    let hostname = url.hostname;\n    let displayNames = {\n      \"www.amazon.com\": \"Amazon\",\n      \"www.bestbuy.com\": \"Best Buy\",\n      \"www.walmart.com\": \"Walmart\",\n    };\n    return displayNames[hostname] ?? defaultName;\n  }\n\n  handleReviewQualityUrlClicked(e) {\n    if (e.target.localName == \"a\" && e.button == 0) {\n      Glean.shopping.surfaceShowQualityExplainerUrlClicked.record();\n    }\n  }\n\n  // Bug 1857620: rather than manually set the utm parameters on the SUMO link,\n  // we should instead update moz-support-link to allow arbitrary utm parameters.\n  render() {\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__analysisexplainerStyles}\"\n      />\n      <shopping-card\n        data-l10n-id=\"shopping-analysis-explainer-label\"\n        data-l10n-attrs=\"label\"\n        type=\"accordion\"\n      >\n        <div slot=\"content\">\n          <div id=\"analysis-explainer-wrapper\">\n            <p data-l10n-id=\"shopping-analysis-explainer-intro2\"></p>\n            ${this.getGradesDescriptionTemplate()}\n            ${this.getGradingScaleListTemplate()}\n            <p\n              data-l10n-id=\"shopping-analysis-explainer-adjusted-rating-description\"\n            ></p>\n            <p\n              data-l10n-id=\"shopping-analysis-explainer-highlights-description\"\n              data-l10n-args=\"${JSON.stringify({\n                retailer: this.getRetailerDisplayName(),\n              })}\"\n            ></p>\n            <p\n              data-l10n-id=\"shopping-analysis-explainer-learn-more2\"\n              @click=${this.handleReviewQualityUrlClicked}\n            >\n              <a\n                id=\"review-quality-url\"\n                data-l10n-name=\"review-quality-url\"\n                target=\"_blank\"\n                href=\"${window.RPMGetFormatURLPref(\n                  \"app.support.baseURL\"\n                )}review-checker-review-quality?as=u&utm_source=inproduct&utm_campaign=learn-more&utm_term=core-sidebar\"\n              ></a>\n            </p>\n          </div>\n        </div>\n      </shopping-card>\n    `;\n  }\n}\n\ncustomElements.define(\"analysis-explainer\", AnalysisExplainer);\n","import __chrome_styles_loader__highlightitemStyles from \"browser/components/shopping/content/highlight-item.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n/**\n * Class for displaying a list of highlighted product reviews, according to highlight category.\n */\nclass Highlight extends MozLitElement {\n  l10nId;\n  highlightType;\n  /**\n   * reviews is a list of Strings, representing all the reviews to display\n   * under a highlight category.\n   */\n  reviews;\n\n  /**\n   * lang defines the language in which the reviews are written. We should specify\n   * language so that screen readers can read text with the appropriate language packs.\n   */\n  lang;\n\n  render() {\n    let ulTemplate = [];\n\n    for (let review of this.reviews) {\n      ulTemplate.push(\n        html`<li>\n          <q><span lang=${this.lang}>${review}</span></q>\n        </li>`\n      );\n    }\n\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__highlightitemStyles}\"\n      />\n      <div class=\"highlight-item-wrapper\">\n        <span class=\"highlight-icon ${this.highlightType}\"></span>\n        <dt class=\"highlight-label\" data-l10n-id=${this.l10nId}></dt>\n        <dd class=\"highlight-details\">\n          <ul class=\"highlight-details-list\">\n            ${ulTemplate}\n          </ul>\n        </dd>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define(\"highlight-item\", Highlight);\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/highlight-item.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/shopping-card.mjs\";\n\nconst VALID_HIGHLIGHT_L10N_IDs = new Map([\n  [\"price\", \"shopping-highlight-price\"],\n  [\"quality\", \"shopping-highlight-quality\"],\n  [\"shipping\", \"shopping-highlight-shipping\"],\n  [\"competitiveness\", \"shopping-highlight-competitiveness\"],\n  [\"packaging/appearance\", \"shopping-highlight-packaging\"],\n]);\n\n/**\n * Class for displaying all available highlight categories for a product and any\n * highlight reviews per category.\n */\nclass ReviewHighlights extends MozLitElement {\n  /**\n   * highlightsMap is a map of highlight categories to an array of reviews per category.\n   * It is possible for a category to have no reviews.\n   */\n  #highlightsMap;\n\n  static properties = {\n    highlights: { type: Object },\n    lang: { type: String, reflect: true },\n  };\n\n  static get queries() {\n    return {\n      reviewHighlightsListEl: \"#review-highlights-list\",\n    };\n  }\n\n  updateHighlightsMap() {\n    let availableKeys;\n    this.#highlightsMap = null;\n\n    try {\n      if (!this.highlights) {\n        return;\n      }\n\n      // Filter highlights that have data.\n      let keys = Object.keys(this.highlights);\n      availableKeys = keys.filter(\n        key => Object.values(this.highlights[key]).flat().length !== 0\n      );\n\n      // Filter valid highlight category types. Valid types are guaranteed to have data-l10n-ids.\n      availableKeys = availableKeys.filter(key =>\n        VALID_HIGHLIGHT_L10N_IDs.has(key)\n      );\n\n      // If there are no highlights to show in the end, stop here and don't render content.\n      if (!availableKeys.length) {\n        return;\n      }\n    } catch (e) {\n      return;\n    }\n\n    this.#highlightsMap = new Map();\n\n    for (let key of availableKeys) {\n      // Ignore negative,neutral,positive sentiments and simply append review strings into one array.\n      let reviews = Object.values(this.highlights[key]).flat();\n      this.#highlightsMap.set(key, reviews);\n    }\n  }\n\n  createHighlightElement(type, reviews) {\n    let highlightEl = document.createElement(\"highlight-item\");\n    // We already verify highlight type and its l10n id in updateHighlightsMap.\n    let l10nId = VALID_HIGHLIGHT_L10N_IDs.get(type);\n    highlightEl.id = type;\n    highlightEl.l10nId = l10nId;\n    highlightEl.highlightType = type;\n    highlightEl.reviews = reviews;\n    highlightEl.lang = this.lang;\n    return highlightEl;\n  }\n\n  render() {\n    this.updateHighlightsMap();\n\n    if (!this.#highlightsMap) {\n      this.hidden = true;\n      return null;\n    }\n\n    this.hidden = false;\n\n    let highlightsTemplate = [];\n    for (let [key, value] of this.#highlightsMap) {\n      let highlightEl = this.createHighlightElement(key, value);\n      highlightsTemplate.push(highlightEl);\n    }\n\n    return html`\n      <shopping-card\n        data-l10n-id=\"shopping-highlights-label\"\n        data-l10n-attrs=\"label\"\n        type=\"show-more\"\n      >\n        <div slot=\"content\" id=\"review-highlights-wrapper\">\n          <dl id=\"review-highlights-list\">${highlightsTemplate}</dl>\n        </div>\n      </shopping-card>\n    `;\n  }\n}\n\ncustomElements.define(\"review-highlights\", ReviewHighlights);\n","import __chrome_styles_loader__lettergradeStyles from \"browser/components/shopping/content/letter-grade.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\nconst VALID_LETTER_GRADE_L10N_IDS = new Map([\n  [\"A\", \"shopping-letter-grade-description-ab\"],\n  [\"B\", \"shopping-letter-grade-description-ab\"],\n  [\"C\", \"shopping-letter-grade-description-c\"],\n  [\"D\", \"shopping-letter-grade-description-df\"],\n  [\"F\", \"shopping-letter-grade-description-df\"],\n]);\n\nclass LetterGrade extends MozLitElement {\n  #descriptionL10N;\n\n  static properties = {\n    letter: { type: String, reflect: true },\n    showdescription: { type: Boolean, reflect: true },\n  };\n\n  get fluentStrings() {\n    if (!this._fluentStrings) {\n      this._fluentStrings = new Localization([\"browser/shopping.ftl\"], true);\n    }\n    return this._fluentStrings;\n  }\n\n  descriptionTemplate() {\n    if (this.showdescription) {\n      return html`<p\n        id=\"letter-grade-description\"\n        data-l10n-id=${this.#descriptionL10N}\n      ></p>`;\n    }\n\n    return null;\n  }\n\n  render() {\n    // Do not render if letter is invalid\n    if (!VALID_LETTER_GRADE_L10N_IDS.has(this.letter)) {\n      return null;\n    }\n\n    this.#descriptionL10N = VALID_LETTER_GRADE_L10N_IDS.get(this.letter);\n    let tooltipL10NArgs;\n    // Do not localize tooltip if using Storybook.\n    if (!window.IS_STORYBOOK) {\n      const localizedDescription = this.fluentStrings.formatValueSync(\n        this.#descriptionL10N\n      );\n      tooltipL10NArgs = `{\"letter\": \"${this.letter}\", \"description\": \"${localizedDescription}\"}`;\n    }\n\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__lettergradeStyles}\"\n      />\n      <article\n        id=\"letter-grade-wrapper\"\n        data-l10n-id=\"shopping-letter-grade-tooltip\"\n        data-l10n-attrs=\"title\"\n        data-l10n-args=${tooltipL10NArgs}\n      >\n        <p id=\"letter-grade-term\">${this.letter}</p>\n        ${this.descriptionTemplate()}\n      </article>\n    `;\n  }\n}\n\ncustomElements.define(\"letter-grade\", LetterGrade);\n","import __chrome_styles_loader__recommendedadStyles from \"browser/components/shopping/content/recommended-ad.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/shopping-card.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-five-star.mjs\";\n\nconst AD_IMPRESSION_TIMEOUT = 1500;\n\nclass RecommendedAd extends MozLitElement {\n  static properties = {\n    product: { type: Object, reflect: true },\n  };\n\n  static get queries() {\n    return {\n      letterGradeEl: \"letter-grade\",\n      linkEl: \"#recommended-ad-wrapper\",\n      priceEl: \"#price\",\n      ratingEl: \"moz-five-star\",\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (this.initialized) {\n      return;\n    }\n    this.initialized = true;\n\n    document.addEventListener(\"visibilitychange\", this);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    document.removeEventListener(\"visibilitychange\", this);\n    this.resetImpressionTimer();\n    this.revokeImageUrl();\n  }\n\n  startImpressionTimer() {\n    if (!this.timeout && document.visibilityState === \"visible\") {\n      this.timeout = setTimeout(\n        () => this.recordImpression(),\n        AD_IMPRESSION_TIMEOUT\n      );\n    }\n  }\n\n  resetImpressionTimer() {\n    this.timeout = clearTimeout(this.timeout);\n  }\n\n  revokeImageUrl() {\n    if (this.imageUrl) {\n      URL.revokeObjectURL(this.imageUrl);\n    }\n  }\n\n  recordImpression() {\n    if (this.hasImpressed) {\n      return;\n    }\n\n    this.dispatchEvent(\n      new CustomEvent(\"AdImpression\", {\n        bubbles: true,\n        detail: { aid: this.product.aid },\n      })\n    );\n\n    document.removeEventListener(\"visibilitychange\", this);\n    this.resetImpressionTimer();\n\n    this.hasImpressed = true;\n  }\n\n  handleClick(event) {\n    if (event.button === 0 || event.button === 1) {\n      this.dispatchEvent(\n        new CustomEvent(\"AdClicked\", {\n          bubbles: true,\n          detail: { aid: this.product.aid },\n        })\n      );\n    }\n  }\n\n  handleEvent(event) {\n    if (event.type !== \"visibilitychange\") {\n      return;\n    }\n    if (document.visibilityState === \"visible\") {\n      this.startImpressionTimer();\n    } else if (!this.hasImpressed) {\n      this.resetImpressionTimer();\n    }\n  }\n\n  priceTemplate() {\n    // We are only showing prices in USD for now. In the future we will need\n    // to update this to include other currencies.\n    return html`<span id=\"price\">$${this.product.price}</span>`;\n  }\n\n  render() {\n    this.startImpressionTimer();\n\n    this.revokeImageUrl();\n    this.imageUrl = URL.createObjectURL(this.product.image_blob);\n\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__recommendedadStyles}\"\n      />\n      <shopping-card\n        data-l10n-id=\"more-to-consider-ad-label\"\n        data-l10n-attrs=\"label\"\n      >\n        <a id=\"recommended-ad-wrapper\" slot=\"content\" href=${\n          this.product.url\n        } target=\"_blank\" title=\"${this.product.name}\" @click=${\n      this.handleClick\n    } @auxclick=${this.handleClick}>\n          <div id=\"ad-content\">\n            <img id=\"ad-preview-image\" src=${this.imageUrl}></img>\n            <span id=\"ad-title\" lang=\"en\">${this.product.name}</span>\n            <letter-grade letter=\"${this.product.grade}\"></letter-grade>\n          </div>\n          <div id=\"footer\">\n            ${this.priceTemplate()}\n            <moz-five-star rating=${\n              this.product.adjusted_rating\n            }></moz-five-star>\n          </div>\n        </a>\n      </shopping-card>\n      <p data-l10n-id=\"ad-by-fakespot\"></p>\n    `;\n  }\n}\n\ncustomElements.define(\"recommended-ad\", RecommendedAd);\n","/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined } from \"chrome://global/content/vendor/lit.all.mjs\";\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/letter-grade.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/shopping-card.mjs\";\n\nclass ReviewReliability extends MozLitElement {\n  static properties = {\n    letter: { type: String },\n  };\n\n  static get queries() {\n    return {\n      letterGradeEl: \"letter-grade\",\n    };\n  }\n\n  render() {\n    if (!this.letter) {\n      this.hidden = true;\n      return null;\n    }\n\n    return html`\n      <shopping-card\n        data-l10n-id=\"shopping-review-reliability-label\"\n        data-l10n-attrs=\"label\"\n      >\n        <div slot=\"content\">\n          <letter-grade\n            letter=${ifDefined(this.letter)}\n            showdescription\n          ></letter-grade>\n        </div>\n      </shopping-card>\n    `;\n  }\n}\n\ncustomElements.define(\"review-reliability\", ReviewReliability);\n","import __chrome_styles_loader__shoppingpageStyles from \"browser/components/shopping/content/shopping-page.css\";\nimport __chrome_styles_loader__settingsStyles from \"browser/components/shopping/content/settings.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\n/* eslint-env mozilla/remote-page */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-toggle.mjs\";\n\nclass ShoppingSettings extends MozLitElement {\n  static properties = {\n    adsEnabled: { type: Boolean },\n    adsEnabledByUser: { type: Boolean },\n    autoOpenEnabled: { type: Boolean },\n    autoOpenEnabledByUser: { type: Boolean },\n    hostname: { type: String },\n  };\n\n  static get queries() {\n    return {\n      wrapperEl: \"#shopping-settings-wrapper\",\n      recommendationsToggleEl: \"#shopping-settings-recommendations-toggle\",\n      autoOpenToggleEl: \"#shopping-settings-auto-open-toggle\",\n      autoOpenToggleDescriptionEl: \"#shopping-auto-open-description\",\n      dividerEl: \".divider\",\n      sidebarEnabledStateEl: \"#shopping-settings-sidebar-enabled-state\",\n      optOutButtonEl: \"#shopping-settings-opt-out-button\",\n      shoppingCardEl: \"shopping-card\",\n      adsLearnMoreLinkEl: \"#shopping-ads-learn-more-link\",\n      fakespotLearnMoreLinkEl: \"#powered-by-fakespot-link\",\n    };\n  }\n\n  onToggleRecommendations() {\n    this.adsEnabledByUser = this.recommendationsToggleEl.pressed;\n    let action = this.adsEnabledByUser ? \"enabled\" : \"disabled\";\n    Glean.shopping.surfaceAdsSettingToggled.record({ action });\n    RPMSetPref(\n      \"browser.shopping.experience2023.ads.userEnabled\",\n      this.adsEnabledByUser\n    );\n  }\n\n  onToggleAutoOpen() {\n    this.autoOpenEnabledByUser = this.autoOpenToggleEl.pressed;\n    let action = this.autoOpenEnabledByUser ? \"enabled\" : \"disabled\";\n    Glean.shopping.surfaceAutoOpenSettingToggled.record({ action });\n    RPMSetPref(\n      \"browser.shopping.experience2023.autoOpen.userEnabled\",\n      this.autoOpenEnabledByUser\n    );\n    if (!this.autoOpenEnabledByUser) {\n      RPMSetPref(\"browser.shopping.experience2023.active\", false);\n    }\n  }\n\n  onDisableShopping() {\n    window.dispatchEvent(\n      new CustomEvent(\"DisableShopping\", { bubbles: true, composed: true })\n    );\n    Glean.shopping.surfaceOptOutButtonClicked.record();\n  }\n\n  fakespotLinkClicked(e) {\n    if (e.target.localName == \"a\" && e.button == 0) {\n      Glean.shopping.surfacePoweredByFakespotLinkClicked.record();\n    }\n  }\n\n  render() {\n    // Whether we show recommendations at all (including offering a user\n    // control for them) is controlled via a nimbus-enabled pref.\n    let canShowRecommendationToggle = this.adsEnabled;\n\n    let adsToggleMarkup = canShowRecommendationToggle\n      ? html`\n        <div class=\"shopping-settings-toggle-option-wrapper\">\n          <moz-toggle\n            id=\"shopping-settings-recommendations-toggle\"\n            ?pressed=${this.adsEnabledByUser}\n            data-l10n-id=\"shopping-settings-recommendations-toggle\"\n            data-l10n-attrs=\"label\"\n            @toggle=${this.onToggleRecommendations}>\n          </moz-toggle/>\n          <span id=\"shopping-ads-learn-more\" data-l10n-id=\"shopping-settings-recommendations-learn-more2\">\n            <a\n              id=\"shopping-ads-learn-more-link\"\n              target=\"_blank\"\n              href=\"${window.RPMGetFormatURLPref(\n                \"app.support.baseURL\"\n              )}review-checker-review-quality?utm_campaign=learn-more&utm_medium=inproduct&utm_term=core-sidebar#w_ads_for_relevant_products\"\n              data-l10n-name=\"review-quality-url\"\n            ></a>\n          </span>\n        </div>`\n      : null;\n\n    /* Auto-open experiment changes how the settings card appears by:\n     * 1. Showing a new toggle for enabling/disabling auto-open behaviour\n     * 2. Adding a divider between the toggles and opt-out button\n     * 3. Showing text indicating that Review Checker is enabled (not opted-out) above the opt-out button\n     *\n     * Only show if `browser.shopping.experience2023.autoOpen.enabled` is true.\n     */\n    let autoOpenDescriptionL10nId;\n    let autoOpenDescriptionL10nArgs;\n\n    switch (this.hostname) {\n      case \"www.amazon.fr\":\n      case \"www.amazon.de\":\n        autoOpenDescriptionL10nId =\n          \"shopping-settings-auto-open-description-single-site\";\n        autoOpenDescriptionL10nArgs = {\n          currentSite: \"Amazon\",\n        };\n        break;\n      default:\n        autoOpenDescriptionL10nId =\n          \"shopping-settings-auto-open-description-three-sites\";\n        autoOpenDescriptionL10nArgs = {\n          firstSite: \"Amazon\",\n          secondSite: \"Best Buy\",\n          thirdSite: \"Walmart\",\n        };\n    }\n\n    let autoOpenToggleMarkup = this.autoOpenEnabled\n      ? html` <div class=\"shopping-settings-toggle-option-wrapper\">\n          <moz-toggle\n            id=\"shopping-settings-auto-open-toggle\"\n            ?pressed=${this.autoOpenEnabledByUser}\n            data-l10n-id=\"shopping-settings-auto-open-toggle\"\n            data-l10n-attrs=\"label\"\n            @toggle=${this.onToggleAutoOpen}\n          >\n          </moz-toggle>\n          <span\n            id=\"shopping-auto-open-description\"\n            data-l10n-id=${autoOpenDescriptionL10nId}\n            data-l10n-args=${JSON.stringify(autoOpenDescriptionL10nArgs)}\n          ></span>\n        </div>`\n      : null;\n\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__settingsStyles}\"\n      />\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__shoppingpageStyles}\"\n      />\n      <shopping-card\n        data-l10n-id=\"shopping-settings-label\"\n        data-l10n-attrs=\"label\"\n        type=${!this.autoOpenEnabled ? \"accordion\" : \"\"}\n      >\n        <div\n          id=\"shopping-settings-wrapper\"\n          class=${this.autoOpenEnabled\n            ? \"shopping-settings-auto-open-ui-enabled\"\n            : \"\"}\n          slot=\"content\"\n        >\n          <section id=\"shopping-settings-toggles-section\">\n            ${adsToggleMarkup} ${autoOpenToggleMarkup}\n          </section>\n          ${this.autoOpenEnabled\n            ? html`<span class=\"divider\" role=\"separator\"></span>`\n            : null}\n          <section id=\"shopping-settings-opt-out-section\">\n            ${this.autoOpenEnabled\n              ? html`<span\n                  id=\"shopping-settings-sidebar-enabled-state\"\n                  data-l10n-id=\"shopping-settings-sidebar-enabled-state\"\n                ></span>`\n              : null}\n            <button\n              class=\"shopping-button\"\n              id=\"shopping-settings-opt-out-button\"\n              data-l10n-id=\"shopping-settings-opt-out-button\"\n              @click=${this.onDisableShopping}\n            ></button>\n          </section>\n        </div>\n      </shopping-card>\n      <p\n        id=\"powered-by-fakespot\"\n        class=\"deemphasized\"\n        data-l10n-id=\"powered-by-fakespot\"\n        @click=${this.fakespotLinkClicked}\n      >\n        <a\n          id=\"powered-by-fakespot-link\"\n          data-l10n-name=\"fakespot-link\"\n          target=\"_blank\"\n          href=\"https://www.fakespot.com/our-mission?utm_source=review-checker&utm_campaign=fakespot-by-mozilla&utm_medium=inproduct&utm_term=core-sidebar\"\n        ></a>\n      </p>\n    `;\n  }\n}\n\ncustomElements.define(\"shopping-settings\", ShoppingSettings);\n","import __chrome_styles_loader__shoppingpageStyles from \"browser/components/shopping/content/shopping-page.css\";\nimport __chrome_styles_loader__shoppingcardStyles from \"browser/components/shopping/content/shopping-card.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined } from \"chrome://global/content/vendor/lit.all.mjs\";\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\nconst MIN_SHOW_MORE_HEIGHT = 200;\n/**\n * A card container to be used in the shopping sidebar. There are three card types.\n * The default type where no type attribute is required and the card will have no extra functionality.\n * The \"accordion\" type will initially not show any content. The card will contain a arrow to expand the\n * card so all of the content is visible.\n *\n * @property {string} label - The label text that will be used for the card header\n * @property {string} type - (optional) The type of card. No type specified\n *   will be the default card. The other available types are \"accordion\" and \"show-more\".\n */\nclass ShoppingCard extends MozLitElement {\n  static properties = {\n    label: { type: String },\n    type: { type: String },\n    _isExpanded: { type: Boolean },\n  };\n\n  static get queries() {\n    return {\n      detailsEl: \"#shopping-details\",\n      contentEl: \"#content\",\n    };\n  }\n\n  labelTemplate() {\n    if (this.label) {\n      if (this.type === \"accordion\") {\n        return html`\n          <div id=\"label-wrapper\">\n            <h2 id=\"header\">${this.label}</h2>\n            <button\n              tabindex=\"-1\"\n              class=\"icon chevron-icon ghost-button\"\n              aria-labelledby=\"header\"\n              @click=${this.handleChevronButtonClick}\n            ></button>\n          </div>\n        `;\n      }\n      return html`\n        <div id=\"label-wrapper\">\n          <h2 id=\"header\">${this.label}</h2>\n          <slot name=\"rating\"></slot>\n        </div>\n      `;\n    }\n    return \"\";\n  }\n\n  cardTemplate() {\n    if (this.type === \"accordion\") {\n      return html`\n        <details id=\"shopping-details\" @toggle=${this.onCardToggle}>\n          <summary>${this.labelTemplate()}</summary>\n          <div id=\"content\"><slot name=\"content\"></slot></div>\n        </details>\n      `;\n    } else if (this.type === \"show-more\") {\n      return html`\n        ${this.labelTemplate()}\n        <article\n          id=\"content\"\n          class=\"show-more\"\n          aria-describedby=\"content\"\n          expanded=\"false\"\n        >\n          <slot name=\"content\"></slot>\n\n          <footer>\n            <button\n              aria-controls=\"content\"\n              class=\"small-button shopping-button\"\n              data-l10n-id=\"shopping-show-more-button\"\n              @click=${this.handleShowMoreButtonClick}\n            ></button>\n          </footer>\n        </article>\n      `;\n    }\n    return html`\n      ${this.labelTemplate()}\n      <div id=\"content\" aria-describedby=\"content\">\n        <slot name=\"content\"></slot>\n      </div>\n    `;\n  }\n\n  onCardToggle() {\n    const action = this.detailsEl.open ? \"expanded\" : \"collapsed\";\n    let l10nId = this.getAttribute(\"data-l10n-id\");\n    switch (l10nId) {\n      case \"shopping-settings-label\":\n        Glean.shopping.surfaceSettingsExpandClicked.record({ action });\n        break;\n      case \"shopping-analysis-explainer-label\":\n        Glean.shopping.surfaceShowQualityExplainerClicked.record({\n          action,\n        });\n        break;\n    }\n  }\n\n  handleShowMoreButtonClick(e) {\n    this._isExpanded = !this._isExpanded;\n    // toggle show more/show less text\n    e.target.setAttribute(\n      \"data-l10n-id\",\n      this._isExpanded\n        ? \"shopping-show-less-button\"\n        : \"shopping-show-more-button\"\n    );\n    // toggle content expanded attribute\n    this.contentEl.attributes.expanded.value = this._isExpanded;\n\n    let action = this._isExpanded ? \"expanded\" : \"collapsed\";\n    Glean.shopping.surfaceShowMoreReviewsButtonClicked.record({\n      action,\n    });\n  }\n\n  enableShowMoreButton() {\n    this._isExpanded = false;\n    this.toggleAttribute(\"showMoreButtonDisabled\", false);\n    this.contentEl.attributes.expanded.value = false;\n  }\n\n  disableShowMoreButton() {\n    this._isExpanded = true;\n    this.toggleAttribute(\"showMoreButtonDisabled\", true);\n    this.contentEl.attributes.expanded.value = true;\n  }\n\n  handleChevronButtonClick() {\n    this.detailsEl.open = !this.detailsEl.open;\n  }\n\n  firstUpdated() {\n    if (this.type !== \"show-more\") {\n      return;\n    }\n\n    let contentSlot = this.shadowRoot.querySelector(\"slot[name='content']\");\n    let contentSlotEls = contentSlot.assignedElements();\n    if (!contentSlotEls.length) {\n      return;\n    }\n\n    let slottedDiv = contentSlotEls[0];\n\n    this.handleContentSlotResize = this.handleContentSlotResize.bind(this);\n    this.contentResizeObserver = new ResizeObserver(\n      this.handleContentSlotResize\n    );\n    this.contentResizeObserver.observe(slottedDiv);\n  }\n\n  disconnectedCallback() {\n    this.contentResizeObserver?.disconnect();\n  }\n\n  handleContentSlotResize(entries) {\n    for (let entry of entries) {\n      if (entry.contentRect.height === 0) {\n        return;\n      }\n\n      if (entry.contentRect.height < MIN_SHOW_MORE_HEIGHT) {\n        this.disableShowMoreButton();\n      } else if (this.hasAttribute(\"showMoreButtonDisabled\")) {\n        this.enableShowMoreButton();\n      }\n    }\n  }\n\n  render() {\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__shoppingcardStyles}\"\n      />\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__shoppingpageStyles}\"\n      />\n      <article\n        class=\"shopping-card\"\n        aria-labelledby=\"header\"\n        aria-label=${ifDefined(this.label)}\n      >\n        ${this.cardTemplate()}\n      </article>\n    `;\n  }\n}\ncustomElements.define(\"shopping-card\", ShoppingCard);\n","import __chrome_styles_loader__shoppingpageStyles from \"browser/components/shopping/content/shopping-page.css\";\nimport __chrome_styles_loader__commonStyles from \"toolkit/themes/linux/global/in-content/common.css\";\nimport __chrome_styles_loader__shoppingcontainerStyles from \"browser/components/shopping/content/shopping-container.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\n/* eslint-env mozilla/remote-page */\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\nimport { html, ifDefined } from \"chrome://global/content/vendor/lit.all.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/highlights.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/settings.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/adjusted-rating.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/reliability.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/analysis-explainer.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/shopping-message-bar.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/unanalyzed.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/recommended-ad.mjs\";\n\n// The number of pixels that must be scrolled from the\n// top of the sidebar to show the header box shadow.\nconst HEADER_SCROLL_PIXEL_OFFSET = 8;\n\nconst SIDEBAR_CLOSED_COUNT_PREF =\n  \"browser.shopping.experience2023.sidebarClosedCount\";\nconst SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF =\n  \"browser.shopping.experience2023.showKeepSidebarClosedMessage\";\nconst SHOPPING_SIDEBAR_ACTIVE_PREF = \"browser.shopping.experience2023.active\";\n\nexport class ShoppingContainer extends MozLitElement {\n  static properties = {\n    data: { type: Object },\n    showOnboarding: { type: Boolean },\n    productUrl: { type: String },\n    recommendationData: { type: Array },\n    isOffline: { type: Boolean },\n    analysisEvent: { type: Object },\n    userReportedAvailable: { type: Boolean },\n    adsEnabled: { type: Boolean },\n    adsEnabledByUser: { type: Boolean },\n    isAnalysisInProgress: { type: Boolean },\n    analysisProgress: { type: Number },\n    isOverflow: { type: Boolean },\n    autoOpenEnabled: { type: Boolean },\n    autoOpenEnabledByUser: { type: Boolean },\n    showingKeepClosedMessage: { type: Boolean },\n  };\n\n  static get queries() {\n    return {\n      reviewReliabilityEl: \"review-reliability\",\n      adjustedRatingEl: \"adjusted-rating\",\n      highlightsEl: \"review-highlights\",\n      settingsEl: \"shopping-settings\",\n      analysisExplainerEl: \"analysis-explainer\",\n      unanalyzedProductEl: \"unanalyzed-product-card\",\n      shoppingMessageBarEl: \"shopping-message-bar\",\n      recommendedAdEl: \"recommended-ad\",\n      loadingEl: \"#loading-wrapper\",\n      closeButtonEl: \"#close-button\",\n      keepClosedMessageBarEl: \"#keep-closed-message-bar\",\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (this.initialized) {\n      return;\n    }\n    this.initialized = true;\n\n    window.document.addEventListener(\"Update\", this);\n    window.document.addEventListener(\"NewAnalysisRequested\", this);\n    window.document.addEventListener(\"ReanalysisRequested\", this);\n    window.document.addEventListener(\"ReportedProductAvailable\", this);\n    window.document.addEventListener(\"adsEnabledByUserChanged\", this);\n    window.document.addEventListener(\"scroll\", this);\n    window.document.addEventListener(\"UpdateRecommendations\", this);\n    window.document.addEventListener(\"UpdateAnalysisProgress\", this);\n    window.document.addEventListener(\"autoOpenEnabledByUserChanged\", this);\n    window.document.addEventListener(\"ShowKeepClosedMessage\", this);\n    window.document.addEventListener(\"HideKeepClosedMessage\", this);\n\n    window.dispatchEvent(\n      new CustomEvent(\"ContentReady\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  updated() {\n    if (this.focusCloseButton) {\n      this.closeButtonEl.focus();\n    }\n  }\n\n  async _update({\n    data,\n    showOnboarding,\n    productUrl,\n    recommendationData,\n    adsEnabled,\n    adsEnabledByUser,\n    isAnalysisInProgress,\n    analysisProgress,\n    focusCloseButton,\n    autoOpenEnabled,\n    autoOpenEnabledByUser,\n  }) {\n    // If we're not opted in or there's no shopping URL in the main browser,\n    // the actor will pass `null`, which means this will clear out any existing\n    // content in the sidebar.\n    this.data = data;\n    this.showOnboarding = showOnboarding;\n    this.productUrl = productUrl;\n    this.recommendationData = recommendationData;\n    this.isOffline = !navigator.onLine;\n    this.isAnalysisInProgress = isAnalysisInProgress;\n    this.adsEnabled = adsEnabled;\n    this.adsEnabledByUser = adsEnabledByUser;\n    this.analysisProgress = analysisProgress;\n    this.focusCloseButton = focusCloseButton;\n    this.autoOpenEnabled = autoOpenEnabled;\n    this.autoOpenEnabledByUser = autoOpenEnabledByUser;\n  }\n\n  _updateRecommendations({ recommendationData }) {\n    this.recommendationData = recommendationData;\n  }\n\n  _updateAnalysisProgress({ progress }) {\n    this.analysisProgress = progress;\n  }\n\n  handleEvent(event) {\n    switch (event.type) {\n      case \"Update\":\n        this._update(event.detail);\n        break;\n      case \"NewAnalysisRequested\":\n      case \"ReanalysisRequested\":\n        this.isAnalysisInProgress = true;\n        this.analysisEvent = {\n          type: event.type,\n          productUrl: this.productUrl,\n        };\n        window.dispatchEvent(\n          new CustomEvent(\"PolledRequestMade\", {\n            bubbles: true,\n            composed: true,\n          })\n        );\n        break;\n      case \"ReportedProductAvailable\":\n        this.userReportedAvailable = true;\n        window.dispatchEvent(\n          new CustomEvent(\"ReportProductAvailable\", {\n            bubbles: true,\n            composed: true,\n          })\n        );\n        Glean.shopping.surfaceReactivatedButtonClicked.record();\n        break;\n      case \"adsEnabledByUserChanged\":\n        this.adsEnabledByUser = event.detail?.adsEnabledByUser;\n        break;\n      case \"scroll\":\n        let scrollYPosition = window.scrollY;\n        this.isOverflow = scrollYPosition > HEADER_SCROLL_PIXEL_OFFSET;\n        break;\n      case \"UpdateRecommendations\":\n        this._updateRecommendations(event.detail);\n        break;\n      case \"UpdateAnalysisProgress\":\n        this._updateAnalysisProgress(event.detail);\n        break;\n      case \"autoOpenEnabledByUserChanged\":\n        this.autoOpenEnabledByUser = event.detail?.autoOpenEnabledByUser;\n        break;\n      case \"ShowKeepClosedMessage\":\n        this.showingKeepClosedMessage = true;\n        break;\n      case \"HideKeepClosedMessage\":\n        this.showingKeepClosedMessage = false;\n        break;\n    }\n  }\n\n  getHostnameFromProductUrl() {\n    let hostname;\n    try {\n      hostname = new URL(this.productUrl)?.hostname;\n      return hostname;\n    } catch (e) {\n      console.error(`Unknown product url ${this.productUrl}.`);\n      return null;\n    }\n  }\n\n  analysisDetailsTemplate() {\n    /* At present, en is supported as the default language for reviews. As we support more sites,\n     * update `lang` accordingly if highlights need to be displayed in other languages. */\n    let lang;\n    let hostname = this.getHostnameFromProductUrl();\n\n    switch (hostname) {\n      case \"www.amazon.fr\":\n        lang = \"fr\";\n        break;\n      case \"www.amazon.de\":\n        lang = \"de\";\n        break;\n      default:\n        lang = \"en\";\n    }\n    return html`\n      <review-reliability letter=${this.data.grade}></review-reliability>\n      <adjusted-rating\n        rating=${ifDefined(this.data.adjusted_rating)}\n      ></adjusted-rating>\n      <review-highlights\n        .highlights=${this.data.highlights}\n        lang=${lang}\n      ></review-highlights>\n    `;\n  }\n\n  contentTemplate() {\n    // The user requested an analysis which is not done yet.\n    if (\n      this.analysisEvent?.productUrl == this.productUrl &&\n      this.isAnalysisInProgress\n    ) {\n      const isReanalysis = this.analysisEvent.type === \"ReanalysisRequested\";\n      return html`<shopping-message-bar\n          type=${isReanalysis\n            ? \"reanalysis-in-progress\"\n            : \"analysis-in-progress\"}\n          progress=${this.analysisProgress}\n        ></shopping-message-bar>\n        ${isReanalysis ? this.analysisDetailsTemplate() : null}`;\n    }\n\n    if (this.data?.error) {\n      return html`<shopping-message-bar\n        type=\"generic-error\"\n      ></shopping-message-bar>`;\n    }\n\n    if (this.data.page_not_supported) {\n      return html`<shopping-message-bar\n        type=\"page-not-supported\"\n      ></shopping-message-bar>`;\n    }\n\n    if (this.data.deleted_product_reported) {\n      return html`<shopping-message-bar\n        type=\"product-not-available-reported\"\n      ></shopping-message-bar>`;\n    }\n\n    if (this.data.deleted_product) {\n      return this.userReportedAvailable\n        ? html`<shopping-message-bar\n            type=\"thanks-for-reporting\"\n          ></shopping-message-bar>`\n        : html`<shopping-message-bar\n            type=\"product-not-available\"\n          ></shopping-message-bar>`;\n    }\n\n    if (this.data.needs_analysis) {\n      if (!this.data.product_id || typeof this.data.grade != \"string\") {\n        // Product is new to us.\n        return html`<unanalyzed-product-card\n          productUrl=${ifDefined(this.productUrl)}\n        ></unanalyzed-product-card>`;\n      }\n\n      // We successfully analyzed the product before, but the current analysis is outdated and can be updated\n      // via a re-analysis.\n      return html`\n        <shopping-message-bar\n          type=\"stale\"\n          .productUrl=${this.productUrl}\n        ></shopping-message-bar>\n        ${this.analysisDetailsTemplate()}\n      `;\n    }\n\n    if (this.data.not_enough_reviews) {\n      // We already saw and tried to analyze this product before, but there are not enough reviews\n      // to make a detailed analysis.\n      return html`<shopping-message-bar\n        type=\"not-enough-reviews\"\n      ></shopping-message-bar>`;\n    }\n\n    return this.analysisDetailsTemplate();\n  }\n\n  recommendationTemplate() {\n    const canShowAds = this.adsEnabled && this.adsEnabledByUser;\n    if (this.recommendationData?.length && canShowAds) {\n      return html`<recommended-ad\n        .product=${this.recommendationData[0]}\n      ></recommended-ad>`;\n    }\n    return null;\n  }\n\n  /**\n   * @param {object?} options\n   * @param {boolean?} options.animate = true\n   *        Whether to animate the loading state. Defaults to true.\n   *        There will be no animation for users who prefer reduced motion,\n   *        irrespective of the value of this option.\n   */\n  loadingTemplate({ animate = true } = {}) {\n    /* Due to limitations with aria-busy for certain screen readers\n     * (see Bug 1682063), mark loading container as a pseudo image and\n     * use aria-label as a workaround. */\n    return html`\n      <div\n        id=\"loading-wrapper\"\n        data-l10n-id=\"shopping-a11y-loading\"\n        role=\"img\"\n        class=${animate ? \"animate\" : \"\"}\n      >\n        <div class=\"loading-box medium\"></div>\n        <div class=\"loading-box medium\"></div>\n        <div class=\"loading-box large\"></div>\n        <div class=\"loading-box small\"></div>\n        <div class=\"loading-box large\"></div>\n        <div class=\"loading-box small\"></div>\n      </div>\n    `;\n  }\n\n  renderContainer(sidebarContent, hideFooter = false) {\n    return html`<link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__shoppingcontainerStyles}\"\n      />\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__commonStyles}\"\n      />\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__shoppingpageStyles}\"\n      />\n      <div id=\"shopping-container\">\n        <div\n          id=\"header-wrapper\"\n          class=${this.isOverflow ? \"shopping-header-overflow\" : \"\"}\n        >\n          <header id=\"shopping-header\" data-l10n-id=\"shopping-a11y-header\">\n            <h1\n              id=\"shopping-header-title\"\n              data-l10n-id=\"shopping-main-container-title\"\n            ></h1>\n            <p id=\"beta-marker\" data-l10n-id=\"shopping-beta-marker\"></p>\n          </header>\n          <button\n            id=\"close-button\"\n            class=\"ghost-button shopping-button\"\n            data-l10n-id=\"shopping-close-button\"\n            @click=${this.handleCloseButtonClick}\n          ></button>\n        </div>\n        <div id=\"content\" aria-live=\"polite\" aria-busy=${!this.data}>\n          <slot name=\"multi-stage-message-slot\"></slot>\n          ${this.keepClosedMessageTemplate()}${sidebarContent}\n          ${!hideFooter ? this.footerTemplate() : null}\n        </div>\n      </div>`;\n  }\n\n  footerTemplate() {\n    let hostname = this.getHostnameFromProductUrl();\n    return html`\n      <analysis-explainer\n        productUrl=${ifDefined(this.productUrl)}\n      ></analysis-explainer>\n      ${this.recommendationTemplate()}\n      <shopping-settings\n        ?adsEnabled=${this.adsEnabled}\n        ?adsEnabledByUser=${this.adsEnabledByUser}\n        ?autoOpenEnabled=${this.autoOpenEnabled}\n        ?autoOpenEnabledByUser=${this.autoOpenEnabledByUser}\n        .hostname=${hostname}\n      ></shopping-settings>\n    `;\n  }\n\n  keepClosedMessageTemplate() {\n    if (\n      this.autoOpenEnabled &&\n      this.autoOpenEnabledByUser &&\n      this.showingKeepClosedMessage &&\n      RPMGetBoolPref(SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF, true)\n    ) {\n      return html`<shopping-message-bar\n        id=\"keep-closed-message-bar\"\n        type=\"keep-closed\"\n      ></shopping-message-bar>`;\n    }\n    return null;\n  }\n\n  render() {\n    let content;\n    let hideFooter;\n    if (this.showOnboarding) {\n      content = html``;\n      hideFooter = true;\n    } else if (this.isOffline) {\n      content = this.loadingTemplate({ animate: false });\n      hideFooter = true;\n    } else if (!this.data) {\n      if (this.isAnalysisInProgress) {\n        content = html`<shopping-message-bar\n          type=\"analysis-in-progress\"\n          progress=${this.analysisProgress}\n        ></shopping-message-bar>`;\n      } else {\n        content = this.loadingTemplate();\n        hideFooter = true;\n      }\n    } else {\n      content = this.contentTemplate();\n    }\n    return this.renderContainer(content, hideFooter);\n  }\n\n  handleCloseButtonClick() {\n    if (this.autoOpenEnabled && this.autoOpenEnabledByUser) {\n      let sidebarClosedCount = RPMGetIntPref(SIDEBAR_CLOSED_COUNT_PREF, 0);\n      if (\n        !this.showingKeepClosedMessage &&\n        sidebarClosedCount >= 4 &&\n        RPMGetBoolPref(SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF, true)\n      ) {\n        this.showingKeepClosedMessage = true;\n        return;\n      }\n\n      this.showingKeepClosedMessage = false;\n\n      if (sidebarClosedCount >= 6) {\n        RPMSetPref(SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF, false);\n      }\n\n      RPMSetPref(SIDEBAR_CLOSED_COUNT_PREF, sidebarClosedCount + 1);\n    }\n\n    RPMSetPref(SHOPPING_SIDEBAR_ACTIVE_PREF, false);\n    Glean.shopping.surfaceClosed.record({ source: \"closeButton\" });\n  }\n}\n\ncustomElements.define(\"shopping-container\", ShoppingContainer);\n","import __chrome_styles_loader__shoppingpageStyles from \"browser/components/shopping/content/shopping-page.css\";\nimport __chrome_styles_loader__shoppingmessagebarStyles from \"browser/components/shopping/content/shopping-message-bar.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\n/* eslint-env mozilla/remote-page */\n\nimport { html, styleMap } from \"chrome://global/content/vendor/lit.all.mjs\";\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-message-bar.mjs\";\n\nconst SHOPPING_SIDEBAR_ACTIVE_PREF = \"browser.shopping.experience2023.active\";\nconst SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF =\n  \"browser.shopping.experience2023.showKeepSidebarClosedMessage\";\nconst SHOPPING_AUTO_OPEN_SIDEBAR_PREF =\n  \"browser.shopping.experience2023.autoOpen.userEnabled\";\n\nclass ShoppingMessageBar extends MozLitElement {\n  #MESSAGE_TYPES_RENDER_TEMPLATE_MAPPING = new Map([\n    [\"stale\", () => this.staleWarningTemplate()],\n    [\"generic-error\", () => this.genericErrorTemplate()],\n    [\"not-enough-reviews\", () => this.notEnoughReviewsTemplate()],\n    [\"product-not-available\", () => this.productNotAvailableTemplate()],\n    [\"thanks-for-reporting\", () => this.thanksForReportingTemplate()],\n    [\n      \"product-not-available-reported\",\n      () => this.productNotAvailableReportedTemplate(),\n    ],\n    [\"analysis-in-progress\", () => this.analysisInProgressTemplate()],\n    [\"reanalysis-in-progress\", () => this.reanalysisInProgressTemplate()],\n    [\"page-not-supported\", () => this.pageNotSupportedTemplate()],\n    [\"thank-you-for-feedback\", () => this.thankYouForFeedbackTemplate()],\n    [\"keep-closed\", () => this.keepClosedTemplate()],\n  ]);\n\n  static properties = {\n    type: { type: String },\n    productUrl: { type: String, reflect: true },\n    progress: { type: Number, reflect: true },\n  };\n\n  static get queries() {\n    return {\n      reAnalysisButtonEl: \"#message-bar-reanalysis-button\",\n      productAvailableBtnEl: \"#message-bar-report-product-available-btn\",\n      yesKeepClosedButtonEl: \"#yes-keep-closed-button\",\n      noThanksButtonEl: \"#no-thanks-button\",\n    };\n  }\n\n  onClickAnalysisButton() {\n    this.dispatchEvent(\n      new CustomEvent(\"ReanalysisRequested\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n    Glean.shopping.surfaceReanalyzeClicked.record();\n  }\n\n  onClickProductAvailable() {\n    this.dispatchEvent(\n      new CustomEvent(\"ReportedProductAvailable\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  handleNoThanksClick() {\n    RPMSetPref(SHOPPING_SIDEBAR_ACTIVE_PREF, false);\n    RPMSetPref(SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF, false);\n    this.dispatchEvent(\n      new CustomEvent(\"HideKeepClosedMessage\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n    Glean.shopping.surfaceNoThanksButtonClicked.record();\n  }\n\n  handleKeepClosedClick() {\n    RPMSetPref(SHOPPING_SIDEBAR_ACTIVE_PREF, false);\n    RPMSetPref(SHOW_KEEP_SIDEBAR_CLOSED_MESSAGE_PREF, false);\n    RPMSetPref(SHOPPING_AUTO_OPEN_SIDEBAR_PREF, false);\n    this.dispatchEvent(\n      new CustomEvent(\"HideKeepClosedMessage\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n    Glean.shopping.surfaceYesKeepClosedButtonClicked.record();\n  }\n\n  staleWarningTemplate() {\n    return html`<div class=\"shopping-message-bar\">\n      <span class=\"icon\"></span>\n      <article id=\"message-bar-container\" aria-labelledby=\"header\">\n        <span\n          data-l10n-id=\"shopping-message-bar-warning-stale-analysis-message-2\"\n        ></span>\n        <button\n          id=\"message-bar-reanalysis-button\"\n          class=\"small-button shopping-button\"\n          data-l10n-id=\"shopping-message-bar-warning-stale-analysis-button\"\n          @click=${this.onClickAnalysisButton}\n        ></button>\n      </article>\n    </div>`;\n  }\n\n  genericErrorTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"warning\"\n      data-l10n-id=\"shopping-message-bar-generic-error\"\n    >\n    </moz-message-bar>`;\n  }\n\n  notEnoughReviewsTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"warning\"\n      data-l10n-id=\"shopping-message-bar-warning-not-enough-reviews\"\n    >\n    </moz-message-bar>`;\n  }\n\n  productNotAvailableTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"warning\"\n      data-l10n-id=\"shopping-message-bar-warning-product-not-available\"\n    >\n      <button\n        slot=\"actions\"\n        id=\"message-bar-report-product-available-btn\"\n        class=\"small-button shopping-button\"\n        data-l10n-id=\"shopping-message-bar-warning-product-not-available-button2\"\n        @click=${this.onClickProductAvailable}\n      ></button>\n    </moz-message-bar>`;\n  }\n\n  thanksForReportingTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"info\"\n      data-l10n-id=\"shopping-message-bar-thanks-for-reporting\"\n    >\n    </moz-message-bar>`;\n  }\n\n  productNotAvailableReportedTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"warning\"\n      data-l10n-id=\"shopping-message-bar-warning-product-not-available-reported\"\n    >\n    </moz-message-bar>`;\n  }\n\n  analysisInProgressTemplate() {\n    return html`<div\n      class=\"shopping-message-bar analysis-in-progress\"\n      style=${styleMap({\n        \"--analysis-progress-pcent\": `${this.progress}%`,\n      })}\n    >\n      <span class=\"icon\"></span>\n      <article\n        id=\"message-bar-container\"\n        aria-labelledby=\"header\"\n        type=\"analysis\"\n      >\n        <strong\n          id=\"header\"\n          data-l10n-id=\"shopping-message-bar-analysis-in-progress-with-amount\"\n          data-l10n-args=\"${JSON.stringify({\n            percentage: Math.round(this.progress),\n          })}\"\n        ></strong>\n        <span\n          data-l10n-id=\"shopping-message-bar-analysis-in-progress-message2\"\n        ></span>\n      </article>\n    </div>`;\n  }\n\n  reanalysisInProgressTemplate() {\n    return html`<div\n      class=\"shopping-message-bar\"\n      id=\"reanalysis-in-progress-message\"\n      style=${styleMap({\n        \"--analysis-progress-pcent\": `${this.progress}%`,\n      })}\n    >\n      <span class=\"icon\"></span>\n      <article\n        id=\"message-bar-container\"\n        aria-labelledby=\"header\"\n        type=\"re-analysis\"\n      >\n        <span\n          id=\"header\"\n          data-l10n-id=\"shopping-message-bar-analysis-in-progress-with-amount\"\n          data-l10n-args=\"${JSON.stringify({\n            percentage: Math.round(this.progress),\n          })}\"\n        ></span>\n      </article>\n    </div>`;\n  }\n\n  pageNotSupportedTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"warning\"\n      data-l10n-id=\"shopping-message-bar-page-not-supported\"\n    >\n    </moz-message-bar>`;\n  }\n\n  thankYouForFeedbackTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading\"\n      type=\"success\"\n      dismissable\n      data-l10n-id=\"shopping-survey-thanks\"\n    >\n    </moz-message-bar>`;\n  }\n\n  keepClosedTemplate() {\n    return html`<moz-message-bar\n      data-l10n-attrs=\"heading, message\"\n      type=\"info\"\n      data-l10n-id=\"shopping-message-bar-keep-closed-header\"\n    >\n      <moz-button-group slot=\"actions\">\n        <button\n          id=\"no-thanks-button\"\n          class=\"small-button shopping-button\"\n          data-l10n-id=\"shopping-message-bar-keep-closed-dismiss-button\"\n          @click=${this.handleNoThanksClick}\n        ></button>\n        <button\n          id=\"yes-keep-closed-button\"\n          class=\"primary small-button shopping-button\"\n          data-l10n-id=\"shopping-message-bar-keep-closed-accept-button\"\n          @click=${this.handleKeepClosedClick}\n        ></button>\n      </moz-button-group>\n    </moz-message-bar>`;\n  }\n\n  render() {\n    let messageBarTemplate = this.#MESSAGE_TYPES_RENDER_TEMPLATE_MAPPING.get(\n      this.type\n    )();\n    if (messageBarTemplate) {\n      if (this.type == \"stale\") {\n        Glean.shopping.surfaceStaleAnalysisShown.record();\n      }\n      return html`\n        <link\n          rel=\"stylesheet\"\n          href=\"${__chrome_styles_loader__shoppingmessagebarStyles}\"\n        />\n        <link\n          rel=\"stylesheet\"\n          href=\"${__chrome_styles_loader__shoppingpageStyles}\"\n        />\n        ${messageBarTemplate}\n      `;\n    }\n    return null;\n  }\n}\n\ncustomElements.define(\"shopping-message-bar\", ShoppingMessageBar);\n","import __chrome_styles_loader__unanalyzedStyles from \"browser/components/shopping/content/unanalyzed.css\";\n/* -*- indent-tabs-mode: nil; js-indent-level: 2 -*-\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html } from \"chrome://global/content/vendor/lit.all.mjs\";\n\nimport { MozLitElement } from \"chrome://global/content/lit-utils.mjs\";\n\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://browser/content/shopping/shopping-card.mjs\";\n\nclass UnanalyzedProductCard extends MozLitElement {\n  static properties = {\n    productURL: { type: String, reflect: true },\n  };\n\n  static get queries() {\n    return {\n      analysisButtonEl: \"#unanalyzed-product-analysis-button\",\n    };\n  }\n\n  onClickAnalysisButton() {\n    this.dispatchEvent(\n      new CustomEvent(\"NewAnalysisRequested\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n    Glean.shopping.surfaceAnalyzeReviewsNoneAvailableClicked.record();\n  }\n\n  render() {\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__unanalyzedStyles}\"\n      />\n      <shopping-card>\n        <div id=\"unanalyzed-product-wrapper\" slot=\"content\">\n          <img id=\"unanalyzed-product-icon\" role=\"presentation\" alt=\"\"></img>\n          <div id=\"unanalyzed-product-message-content\">\n            <h2\n              data-l10n-id=\"shopping-unanalyzed-product-header-2\"\n            ></h2>\n            <p data-l10n-id=\"shopping-unanalyzed-product-message-2\"></p>\n          </div>\n          <button\n            id=\"unanalyzed-product-analysis-button\"\n            class=\"primary\"\n            data-l10n-id=\"shopping-unanalyzed-product-analyze-button\"\n            @click=${this.onClickAnalysisButton}\n          ></button>\n        </div>\n      </shopping-card>\n    `;\n  }\n}\n\ncustomElements.define(\"unanalyzed-product-card\", UnanalyzedProductCard);\n","import __chrome_styles_loader__mozbuttonStyles from \"toolkit/content/widgets/moz-button/moz-button.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined, classMap } from \"../vendor/lit.all.mjs\";\nimport { MozLitElement } from \"../lit-utils.mjs\";\n\n/**\n * A button with multiple types and two sizes.\n *\n * @tagname moz-button\n * @property {string} label - The button's label, will be overridden by slotted content.\n * @property {string} type - The button type.\n *   Options: default, primary, destructive, icon, icon ghost, ghost.\n * @property {string} size - The button size.\n *   Options: default, small.\n * @property {boolean} disabled - The disabled state.\n * @property {string} title - The button's title attribute, used in shadow DOM and therefore not as an attribute on moz-button.\n * @property {string} titleAttribute - Internal, map title attribute to the title JS property.\n * @property {string} tooltipText - Set the title property, the title attribute will be used first.\n * @property {string} ariaLabel - The button's arial-label attribute, used in shadow DOM and therefore not as an attribute on moz-button.\n * @property {string} iconSrc - Path to the icon that should be displayed in the button.\n * @property {string} ariaLabelAttribute - Internal, map aria-label attribute to the ariaLabel JS property.\n * @property {string} hasVisibleLabel - Internal, tracks whether or not the button has a visible label.\n * @property {HTMLButtonElement} buttonEl - The internal button element in the shadow DOM.\n * @property {HTMLButtonElement} slotEl - The internal slot element in the shadow DOM.\n * @slot default - The button's content, overrides label property.\n * @fires click - The click event.\n */\nexport default class MozButton extends MozLitElement {\n  static shadowRootOptions = {\n    ...MozLitElement.shadowRootOptions,\n    delegatesFocus: true,\n  };\n\n  static properties = {\n    label: { type: String, reflect: true },\n    type: { type: String, reflect: true },\n    size: { type: String, reflect: true },\n    disabled: { type: Boolean, reflect: true },\n    title: { type: String, state: true },\n    titleAttribute: { type: String, attribute: \"title\", reflect: true },\n    tooltipText: { type: String },\n    ariaLabelAttribute: {\n      type: String,\n      attribute: \"aria-label\",\n      reflect: true,\n    },\n    ariaLabel: { type: String, state: true },\n    iconSrc: { type: String },\n    hasVisibleLabel: { type: Boolean, state: true },\n  };\n\n  static queries = {\n    buttonEl: \"button\",\n    slotEl: \"slot\",\n  };\n\n  constructor() {\n    super();\n    this.type = \"default\";\n    this.size = \"default\";\n    this.disabled = false;\n    this.hasVisibleLabel = !!this.label;\n  }\n\n  willUpdate(changes) {\n    if (changes.has(\"titleAttribute\")) {\n      this.title = this.titleAttribute;\n      this.titleAttribute = null;\n    }\n    if (changes.has(\"ariaLabelAttribute\")) {\n      this.ariaLabel = this.ariaLabelAttribute;\n      this.ariaLabelAttribute = null;\n    }\n  }\n\n  // Delegate clicks on host to the button element.\n  click() {\n    this.buttonEl.click();\n  }\n\n  checkForLabelText() {\n    this.hasVisibleLabel = this.slotEl\n      .assignedNodes()\n      .some(node => node.textContent.trim());\n  }\n\n  render() {\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__mozbuttonStyles}\"\n      />\n      <button\n        type=${this.type}\n        size=${this.size}\n        ?disabled=${this.disabled}\n        title=${ifDefined(this.title || this.tooltipText)}\n        aria-label=${ifDefined(this.ariaLabel)}\n        part=\"button\"\n        class=${classMap({ labelled: this.label || this.hasVisibleLabel })}\n      >\n        ${this.iconSrc\n          ? html`<img src=${this.iconSrc} role=\"presentation\" />`\n          : \"\"}\n        <slot @slotchange=${this.checkForLabelText}>${this.label}</slot>\n      </button>\n    `;\n  }\n}\ncustomElements.define(\"moz-button\", MozButton);\n","import __chrome_styles_loader__mozfivestarStyles from \"toolkit/content/widgets/moz-five-star/moz-five-star.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { ifDefined, html } from \"../vendor/lit.all.mjs\";\nimport { MozLitElement } from \"../lit-utils.mjs\";\n\nwindow.MozXULElement?.insertFTLIfNeeded(\"toolkit/global/mozFiveStar.ftl\");\n\n/**\n * The visual representation is five stars, each of them either empty,\n * half-filled or full. The fill state is derived from the rating,\n * rounded to the nearest half.\n *\n * @tagname moz-five-star\n * @property {number} rating - The rating out of 5.\n * @property {string} title - The title text.\n */\nexport default class MozFiveStar extends MozLitElement {\n  static properties = {\n    rating: { type: Number, reflect: true },\n    title: { type: String },\n  };\n\n  static get queries() {\n    return {\n      starEls: { all: \".rating-star\" },\n      starsWrapperEl: \".stars\",\n    };\n  }\n\n  getStarsFill() {\n    let starFill = [];\n    let roundedRating = Math.round(this.rating * 2) / 2;\n    for (let i = 1; i <= 5; i++) {\n      if (i <= roundedRating) {\n        starFill.push(\"full\");\n      } else if (i - roundedRating === 0.5) {\n        starFill.push(\"half\");\n      } else {\n        starFill.push(\"empty\");\n      }\n    }\n    return starFill;\n  }\n\n  render() {\n    let starFill = this.getStarsFill();\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__mozfivestarStyles}\"\n      />\n      <div\n        class=\"stars\"\n        role=\"img\"\n        data-l10n-id=${ifDefined(\n          this.title ? undefined : \"moz-five-star-rating\"\n        )}\n        data-l10n-args=${ifDefined(\n          this.title ? undefined : JSON.stringify({ rating: this.rating ?? 0 })\n        )}\n      >\n        ${starFill.map(\n          fill => html`<span class=\"rating-star\" fill=\"${fill}\"></span>`\n        )}\n      </div>\n    `;\n  }\n}\ncustomElements.define(\"moz-five-star\", MozFiveStar);\n","import __chrome_styles_loader__mozlabelStyles from \"toolkit/content/widgets/moz-label/moz-label.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\n/**\n * An extension of the label element that provides accesskey styling and\n * formatting as well as click handling logic.\n *\n * @tagname moz-label\n * @attribute {string} accesskey - Key used for keyboard access.\n */\nclass MozTextLabel extends HTMLLabelElement {\n  #insertSeparator = false;\n  #alwaysAppendAccessKey = false;\n  #lastFormattedAccessKey = null;\n\n  // Default to underlining accesskeys for Windows and Linux.\n  static #underlineAccesskey = !navigator.platform.includes(\"Mac\");\n  static get observedAttributes() {\n    return [\"accesskey\"];\n  }\n\n  static stylesheetUrl = __chrome_styles_loader__mozlabelStyles;\n\n  constructor() {\n    super();\n    this.#register();\n    this.addEventListener(\"click\", this._onClick);\n  }\n\n  #register() {\n    if (window.IS_STORYBOOK) {\n      MozTextLabel.#underlineAccesskey = true;\n    } else if (typeof Services !== \"undefined\") {\n      MozTextLabel.#underlineAccesskey = !!Services.prefs.getIntPref(\n        \"ui.key.menuAccessKey\",\n        Number(!navigator.platform.includes(\"Mac\"))\n      );\n      if (MozTextLabel.#underlineAccesskey) {\n        try {\n          const nsIPrefLocalizedString = Ci.nsIPrefLocalizedString;\n          const prefNameInsertSeparator =\n            \"intl.menuitems.insertseparatorbeforeaccesskeys\";\n          const prefNameAlwaysAppendAccessKey =\n            \"intl.menuitems.alwaysappendaccesskeys\";\n\n          let val = Services.prefs.getComplexValue(\n            prefNameInsertSeparator,\n            nsIPrefLocalizedString\n          ).data;\n          this.#insertSeparator = val == \"true\";\n          val = Services.prefs.getComplexValue(\n            prefNameAlwaysAppendAccessKey,\n            nsIPrefLocalizedString\n          ).data;\n          this.#alwaysAppendAccessKey = val == \"true\";\n        } catch (e) {\n          this.#insertSeparator = this.#alwaysAppendAccessKey = true;\n        }\n      }\n    }\n  }\n\n  connectedCallback() {\n    this.#setStyles();\n    this.formatAccessKey();\n  }\n\n  // Bug 1820588 - we may want to generalize this into\n  // MozHTMLElement.insertCssIfNeeded(style)\n  #setStyles() {\n    let root = this.getRootNode();\n    let container = root.head ?? root;\n\n    for (let link of container.querySelectorAll(\"link\")) {\n      if (link.getAttribute(\"href\") == this.constructor.stylesheetUrl) {\n        return;\n      }\n    }\n\n    let style = document.createElement(\"link\");\n    style.rel = \"stylesheet\";\n    style.href = this.constructor.stylesheetUrl;\n    container.appendChild(style);\n  }\n\n  set textContent(val) {\n    super.textContent = val;\n    this.#lastFormattedAccessKey = null;\n    this.formatAccessKey();\n  }\n\n  get textContent() {\n    return super.textContent;\n  }\n\n  attributeChangedCallback(attrName, oldValue, newValue) {\n    if (oldValue == newValue) {\n      return;\n    }\n\n    // Note that this is only happening when \"accesskey\" attribute changes.\n    this.formatAccessKey();\n  }\n\n  _onClick() {\n    let controlElement = this.labeledControlElement;\n    if (!controlElement || this.disabled) {\n      return;\n    }\n    controlElement.focus();\n\n    if (\n      (controlElement.localName == \"checkbox\" ||\n        controlElement.localName == \"radio\") &&\n      controlElement.getAttribute(\"disabled\") == \"true\"\n    ) {\n      return;\n    }\n\n    if (controlElement.localName == \"checkbox\") {\n      controlElement.checked = !controlElement.checked;\n    } else if (controlElement.localName == \"radio\") {\n      controlElement.control.selectedItem = controlElement;\n    }\n  }\n\n  set accessKey(val) {\n    this.setAttribute(\"accesskey\", val);\n    let control = this.labeledControlElement;\n    if (control) {\n      control.setAttribute(\"accesskey\", val);\n    }\n  }\n\n  get accessKey() {\n    let accessKey = this.getAttribute(\"accesskey\");\n    return accessKey ? accessKey[0] : null;\n  }\n\n  get labeledControlElement() {\n    let control = this.control;\n    return control ? document.getElementById(control) : null;\n  }\n\n  set control(val) {\n    this.setAttribute(\"control\", val);\n  }\n\n  get control() {\n    return this.getAttribute(\"control\");\n  }\n\n  // This is used to match the rendering of accesskeys from nsTextBoxFrame.cpp (i.e. when the\n  // label uses [value]). So this is just for when we have textContent.\n  formatAccessKey() {\n    // Skip doing any DOM manipulation whenever possible:\n    let accessKey = this.accessKey;\n    if (\n      !MozTextLabel.#underlineAccesskey ||\n      this.#lastFormattedAccessKey == accessKey ||\n      !this.textContent ||\n      !this.textContent.trim()\n    ) {\n      return;\n    }\n    this.#lastFormattedAccessKey = accessKey;\n    if (this.accessKeySpan) {\n      // Clear old accesskey\n      mergeElement(this.accessKeySpan);\n      this.accessKeySpan = null;\n    }\n\n    if (this.hiddenColon) {\n      mergeElement(this.hiddenColon);\n      this.hiddenColon = null;\n    }\n\n    if (this.accessKeyParens) {\n      this.accessKeyParens.remove();\n      this.accessKeyParens = null;\n    }\n\n    // If we used to have an accessKey but not anymore, we're done here\n    if (!accessKey) {\n      return;\n    }\n\n    let labelText = this.textContent;\n    let accessKeyIndex = -1;\n    if (!this.#alwaysAppendAccessKey) {\n      accessKeyIndex = labelText.indexOf(accessKey);\n      if (accessKeyIndex < 0) {\n        // Try again in upper case\n        accessKeyIndex = labelText\n          .toUpperCase()\n          .indexOf(accessKey.toUpperCase());\n      }\n    } else if (labelText.endsWith(`(${accessKey.toUpperCase()})`)) {\n      accessKeyIndex = labelText.length - (1 + accessKey.length); // = index of accessKey.\n    }\n\n    const HTML_NS = \"http://www.w3.org/1999/xhtml\";\n    this.accessKeySpan = document.createElementNS(HTML_NS, \"span\");\n    this.accessKeySpan.className = \"accesskey\";\n\n    // Note that if you change the following code, see the comment of\n    // nsTextBoxFrame::UpdateAccessTitle.\n\n    // If accesskey is in the string, underline it:\n    if (accessKeyIndex >= 0) {\n      wrapChar(this, this.accessKeySpan, accessKeyIndex);\n      return;\n    }\n\n    // If accesskey is not in string, append in parentheses\n    // If end is colon, we should insert before colon.\n    // i.e., \"label:\" -> \"label(X):\"\n    let colonHidden = false;\n    if (/:$/.test(labelText)) {\n      labelText = labelText.slice(0, -1);\n      this.hiddenColon = document.createElementNS(HTML_NS, \"span\");\n      this.hiddenColon.className = \"hiddenColon\";\n      this.hiddenColon.style.display = \"none\";\n      // Hide the last colon by using span element.\n      // I.e., label<span style=\"display:none;\">:</span>\n      wrapChar(this, this.hiddenColon, labelText.length);\n      colonHidden = true;\n    }\n    // If end is space(U+20),\n    // we should not add space before parentheses.\n    let endIsSpace = false;\n    if (/ $/.test(labelText)) {\n      endIsSpace = true;\n    }\n\n    this.accessKeyParens = document.createElementNS(\n      \"http://www.w3.org/1999/xhtml\",\n      \"span\"\n    );\n    this.appendChild(this.accessKeyParens);\n    if (this.#insertSeparator && !endIsSpace) {\n      this.accessKeyParens.textContent = \" (\";\n    } else {\n      this.accessKeyParens.textContent = \"(\";\n    }\n    this.accessKeySpan.textContent = accessKey.toUpperCase();\n    this.accessKeyParens.appendChild(this.accessKeySpan);\n    if (!colonHidden) {\n      this.accessKeyParens.appendChild(document.createTextNode(\")\"));\n    } else {\n      this.accessKeyParens.appendChild(document.createTextNode(\"):\"));\n    }\n  }\n}\ncustomElements.define(\"moz-label\", MozTextLabel, { extends: \"label\" });\n\nfunction mergeElement(element) {\n  // If the element has been removed already, return:\n  if (!element.isConnected) {\n    return;\n  }\n  // `isInstance` isn't available to web content (i.e. Storybook) so we need to\n  // fallback to using `instanceof`.\n  if (\n    Text.hasOwnProperty(\"isInstance\")\n      ? Text.isInstance(element.previousSibling)\n      : // eslint-disable-next-line mozilla/use-isInstance\n        element.previousSibling instanceof Text\n  ) {\n    element.previousSibling.appendData(element.textContent);\n  } else {\n    element.parentNode.insertBefore(element.firstChild, element);\n  }\n  element.remove();\n}\n\nfunction wrapChar(parentNode, element, index) {\n  let treeWalker = document.createNodeIterator(\n    parentNode,\n    NodeFilter.SHOW_TEXT,\n    null\n  );\n  let node = treeWalker.nextNode();\n  while (index >= node.length) {\n    index -= node.length;\n    node = treeWalker.nextNode();\n  }\n  if (index) {\n    node = node.splitText(index);\n  }\n\n  node.parentNode.insertBefore(element, node);\n  if (node.length > 1) {\n    node.splitText(1);\n  }\n  element.appendChild(node);\n}\n","import __chrome_styles_loader__mozmessagebarStyles from \"toolkit/content/widgets/moz-message-bar/moz-message-bar.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined } from \"../vendor/lit.all.mjs\";\nimport { MozLitElement } from \"../lit-utils.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-button.mjs\";\n\nconst messageTypeToIconData = {\n  info: {\n    iconSrc: \"chrome://global/skin/icons/info-filled.svg\",\n    l10nId: \"moz-message-bar-icon-info\",\n  },\n  warning: {\n    iconSrc: \"chrome://global/skin/icons/warning.svg\",\n    l10nId: \"moz-message-bar-icon-warning\",\n  },\n  success: {\n    iconSrc: \"chrome://global/skin/icons/check-filled.svg\",\n    l10nId: \"moz-message-bar-icon-success\",\n  },\n  error: {\n    iconSrc: \"chrome://global/skin/icons/error.svg\",\n    l10nId: \"moz-message-bar-icon-error\",\n  },\n  critical: {\n    iconSrc: \"chrome://global/skin/icons/error.svg\",\n    l10nId: \"moz-message-bar-icon-error\",\n  },\n};\n\n/**\n * A simple message bar element that can be used to display\n * important information to users.\n *\n * @tagname moz-message-bar\n * @property {string} type - The type of the displayed message.\n * @property {string} heading - The heading of the message.\n * @property {string} message - The message text.\n * @property {boolean} dismissable - Whether or not the element is dismissable.\n * @property {string} messageL10nId - l10n ID for the message.\n * @property {string} messageL10nArgs - Any args needed for the message l10n ID.\n * @fires message-bar:close\n *  Custom event indicating that message bar was closed.\n * @fires message-bar:user-dismissed\n *  Custom event indicating that message bar was dismissed by the user.\n */\n\nexport default class MozMessageBar extends MozLitElement {\n  static queries = {\n    actionsSlot: \"slot[name=actions]\",\n    actionsEl: \".actions\",\n    closeButton: \"moz-button.close\",\n    supportLinkSlot: \"slot[name=support-link]\",\n  };\n\n  static properties = {\n    type: { type: String },\n    heading: { type: String },\n    message: { type: String },\n    dismissable: { type: Boolean },\n    messageL10nId: { type: String },\n    messageL10nArgs: { type: String },\n  };\n\n  constructor() {\n    super();\n    window.MozXULElement?.insertFTLIfNeeded(\"toolkit/global/mozMessageBar.ftl\");\n    this.type = \"info\";\n    this.dismissable = false;\n  }\n\n  onSlotchange() {\n    let actions = this.actionsSlot.assignedNodes();\n    this.actionsEl.classList.toggle(\"active\", actions.length);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.setAttribute(\"role\", \"alert\");\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.dispatchEvent(new CustomEvent(\"message-bar:close\"));\n  }\n\n  get supportLinkEls() {\n    return this.supportLinkSlot.assignedElements();\n  }\n\n  iconTemplate() {\n    let iconData = messageTypeToIconData[this.type];\n    if (iconData) {\n      let { iconSrc, l10nId } = iconData;\n      return html`\n        <div class=\"icon-container\">\n          <img\n            class=\"icon\"\n            src=${iconSrc}\n            data-l10n-id=${l10nId}\n            data-l10n-attrs=\"alt\"\n          />\n        </div>\n      `;\n    }\n    return \"\";\n  }\n\n  headingTemplate() {\n    if (this.heading) {\n      return html`<strong class=\"heading\">${this.heading}</strong>`;\n    }\n    return \"\";\n  }\n\n  closeButtonTemplate({ size } = {}) {\n    if (this.dismissable) {\n      return html`\n        <moz-button\n          type=\"icon ghost\"\n          class=\"close\"\n          size=${ifDefined(size)}\n          data-l10n-id=\"moz-message-bar-close-button\"\n          @click=${this.dismiss}\n        ></moz-button>\n      `;\n    }\n    return \"\";\n  }\n\n  render() {\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__mozmessagebarStyles}\"\n      />\n      <div class=\"container\">\n        <div class=\"content\">\n          <div class=\"text-container\">\n            ${this.iconTemplate()}\n            <div class=\"text-content\">\n              ${this.headingTemplate()}\n              <div>\n                <span\n                  class=\"message\"\n                  data-l10n-id=${ifDefined(this.messageL10nId)}\n                  data-l10n-args=${ifDefined(\n                    JSON.stringify(this.messageL10nArgs)\n                  )}\n                >\n                  ${this.message}\n                </span>\n                <span class=\"link\">\n                  <slot name=\"support-link\"></slot>\n                </span>\n              </div>\n            </div>\n          </div>\n          <span class=\"actions\">\n            <slot name=\"actions\" @slotchange=${this.onSlotchange}></slot>\n          </span>\n        </div>\n        ${this.closeButtonTemplate()}\n      </div>\n    `;\n  }\n\n  dismiss() {\n    this.dispatchEvent(new CustomEvent(\"message-bar:user-dismissed\"));\n    this.close();\n  }\n\n  close() {\n    this.remove();\n  }\n}\n\ncustomElements.define(\"moz-message-bar\", MozMessageBar);\n","/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nwindow.MozXULElement?.insertFTLIfNeeded(\"toolkit/global/mozSupportLink.ftl\");\n\n/**\n * An extension of the anchor element that helps create links to Mozilla's\n * support documentation. This should be used for SUMO links only - other \"Learn\n * more\" links can use the regular anchor element.\n *\n * @tagname moz-support-link\n * @attribute {string} support-page - Short-hand string from SUMO to the specific support page.\n * @attribute {string} utm-content - UTM parameter for a URL, if it is an AMO URL.\n * @attribute {string} data-l10n-id - Fluent ID used to generate the text content.\n */\nexport default class MozSupportLink extends HTMLAnchorElement {\n  static SUPPORT_URL = \"https://www.mozilla.org/\";\n  static get observedAttributes() {\n    return [\"support-page\", \"utm-content\"];\n  }\n\n  /**\n   * Handles setting up the SUPPORT_URL preference getter.\n   * Without this, the tests for this component may not behave\n   * as expected.\n   * @private\n   * @memberof MozSupportLink\n   */\n  #register() {\n    if (window.document.nodePrincipal?.isSystemPrincipal) {\n      ChromeUtils.defineESModuleGetters(MozSupportLink, {\n        BrowserUtils: \"resource://gre/modules/BrowserUtils.sys.mjs\",\n      });\n\n      // eslint-disable-next-line no-shadow\n      let { XPCOMUtils } = window.XPCOMUtils\n        ? window\n        : ChromeUtils.importESModule(\n            \"resource://gre/modules/XPCOMUtils.sys.mjs\"\n          );\n      XPCOMUtils.defineLazyPreferenceGetter(\n        MozSupportLink,\n        \"SUPPORT_URL\",\n        \"app.support.baseURL\",\n        \"\",\n        null,\n        val => Services.urlFormatter.formatURL(val)\n      );\n    } else if (!window.IS_STORYBOOK) {\n      MozSupportLink.SUPPORT_URL = window.RPMGetFormatURLPref(\n        \"app.support.baseURL\"\n      );\n    }\n  }\n\n  connectedCallback() {\n    this.#register();\n    this.#setHref();\n    this.setAttribute(\"target\", \"_blank\");\n    this.addEventListener(\"click\", this);\n    if (\n      !this.getAttribute(\"data-l10n-id\") &&\n      !this.getAttribute(\"data-l10n-name\") &&\n      !this.childElementCount\n    ) {\n      document.l10n.setAttributes(this, \"moz-support-link-text\");\n    }\n    document.l10n.translateFragment(this);\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener(\"click\", this);\n  }\n\n  handleEvent(e) {\n    if (e.type == \"click\") {\n      if (window.openTrustedLinkIn) {\n        let where = MozSupportLink.BrowserUtils.whereToOpenLink(e, false, true);\n        if (where == \"current\") {\n          where = \"tab\";\n        }\n        e.preventDefault();\n        openTrustedLinkIn(this.href, where);\n      }\n    }\n  }\n\n  attributeChangedCallback(attrName) {\n    if (attrName === \"support-page\" || attrName === \"utm-content\") {\n      this.#setHref();\n    }\n  }\n\n  #setHref() {\n    let supportPage = this.getAttribute(\"support-page\") ?? \"\";\n    let base = MozSupportLink.SUPPORT_URL + supportPage;\n    this.href = this.hasAttribute(\"utm-content\")\n      ? formatUTMParams(this.getAttribute(\"utm-content\"), base)\n      : base;\n  }\n}\ncustomElements.define(\"moz-support-link\", MozSupportLink, { extends: \"a\" });\n\n/**\n * Adds UTM parameters to a given URL, if it is an AMO URL.\n *\n * @param {string} contentAttribute\n *        Identifies the part of the UI with which the link is associated.\n * @param {string} url\n * @returns {string}\n *          The url with UTM parameters if it is an AMO URL.\n *          Otherwise the url in unmodified form.\n */\nexport function formatUTMParams(contentAttribute, url) {\n  if (!contentAttribute) {\n    return url;\n  }\n  let parsedUrl = new URL(url);\n  let domain = `.${parsedUrl.hostname}`;\n  if (\n    !domain.endsWith(\".mozilla.org\") &&\n    // For testing: addons-dev.allizom.org and addons.allizom.org\n    !domain.endsWith(\".allizom.org\")\n  ) {\n    return url;\n  }\n\n  parsedUrl.searchParams.set(\"utm_source\", \"firefox-browser\");\n  parsedUrl.searchParams.set(\"utm_medium\", \"firefox-browser\");\n  parsedUrl.searchParams.set(\"utm_content\", contentAttribute);\n  return parsedUrl.href;\n}\n","import __chrome_styles_loader__moztoggleStyles from \"toolkit/content/widgets/moz-toggle/moz-toggle.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at htp://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined } from \"../vendor/lit.all.mjs\";\nimport { MozLitElement } from \"../lit-utils.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"chrome://global/content/elements/moz-label.mjs\";\n\n/**\n * A simple toggle element that can be used to switch between two states.\n *\n * @tagname moz-toggle\n * @property {boolean} pressed - Whether or not the element is pressed.\n * @property {boolean} disabled - Whether or not the element is disabled.\n * @property {string} label - The label text.\n * @property {string} description - The description text.\n * @property {string} ariaLabel\n *  The aria-label text for cases where there is no visible label.\n * @slot support-link - Used to append a moz-support-link to the description.\n * @fires toggle\n *  Custom event indicating that the toggle's pressed state has changed.\n */\nexport default class MozToggle extends MozLitElement {\n  static shadowRootOptions = {\n    ...MozLitElement.shadowRootOptions,\n    delegatesFocus: true,\n  };\n\n  static properties = {\n    pressed: { type: Boolean, reflect: true },\n    disabled: { type: Boolean, reflect: true },\n    label: { type: String },\n    description: { type: String },\n    ariaLabel: { type: String, attribute: \"aria-label\" },\n    accessKey: { type: String, attribute: \"accesskey\" },\n  };\n\n  static get queries() {\n    return {\n      buttonEl: \"#moz-toggle-button\",\n      labelEl: \"#moz-toggle-label\",\n      descriptionEl: \"#moz-toggle-description\",\n    };\n  }\n\n  constructor() {\n    super();\n    this.pressed = false;\n    this.disabled = false;\n  }\n\n  handleClick() {\n    this.pressed = !this.pressed;\n    this.dispatchOnUpdateComplete(\n      new CustomEvent(\"toggle\", {\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  // Delegate clicks on the host to the input element\n  click() {\n    this.buttonEl.click();\n  }\n\n  descriptionTemplate() {\n    if (this.description) {\n      return html`\n        <p\n          id=\"moz-toggle-description\"\n          class=\"description-wrapper text-deemphasized\"\n          part=\"description\"\n        >\n          ${this.description} ${this.supportLinkTemplate()}\n        </p>\n      `;\n    }\n    return \"\";\n  }\n\n  supportLinkTemplate() {\n    return html` <slot name=\"support-link\"></slot> `;\n  }\n\n  buttonTemplate() {\n    const { pressed, disabled, description, ariaLabel, handleClick } = this;\n    return html`\n      <button\n        id=\"moz-toggle-button\"\n        part=\"button\"\n        type=\"button\"\n        class=\"toggle-button\"\n        ?disabled=${disabled}\n        aria-pressed=${pressed}\n        aria-label=${ifDefined(ariaLabel ?? undefined)}\n        aria-describedby=${ifDefined(\n          description ? \"moz-toggle-description\" : undefined\n        )}\n        @click=${handleClick}\n      ></button>\n    `;\n  }\n\n  render() {\n    return html`\n      <link\n        rel=\"stylesheet\"\n        href=\"${__chrome_styles_loader__moztoggleStyles}\"\n      />\n      ${this.label\n        ? html`\n            <label\n              is=\"moz-label\"\n              id=\"moz-toggle-label\"\n              part=\"label\"\n              for=\"moz-toggle-button\"\n              accesskey=${ifDefined(this.accessKey)}\n            >\n              <span>\n                ${this.label}\n                ${!this.description ? this.supportLinkTemplate() : \"\"}\n              </span>\n              ${this.buttonTemplate()}\n            </label>\n          `\n        : this.buttonTemplate()}\n      ${this.descriptionTemplate()}\n    `;\n  }\n}\ncustomElements.define(\"moz-toggle\", MozToggle);\n","/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\n// eslint-disable-next-line import/no-unresolved\nimport { html, ifDefined } from \"lit.all.mjs\";\n// eslint-disable-next-line import/no-unassigned-import\nimport \"browser/components/shopping/content/shopping-container.mjs\";\n// Bug 1845737: These should get imported by ShoppingMessageBar\nwindow.MozXULElement.insertFTLIfNeeded(\"browser/shopping.ftl\");\nwindow.MozXULElement.insertFTLIfNeeded(\"toolkit/branding/brandings.ftl\");\n// Mock for Glean\nif (typeof window.Glean == \"undefined\") {\n  window.Glean = new Proxy(() => {}, { get: () => window.Glean });\n}\n\nexport default {\n  title: \"Domain-specific UI Widgets/Shopping/Shopping Container\",\n  component: \"shopping-container\",\n  parameters: {\n    status: \"in-development\",\n  },\n};\n\nconst MOCK_HIGHLIGHTS = {\n  price: {\n    positive: [\"This watch is great and the price was even better.\"],\n    negative: [],\n    neutral: [],\n  },\n  quality: {\n    positive: [\n      \"Other than that, I am very impressed with the watch and its capabilities.\",\n      \"This watch performs above expectations in every way with the exception of the heart rate monitor.\",\n    ],\n    negative: [\n      \"Battery life is no better than the 3 even with the solar gimmick, probably worse.\",\n    ],\n    neutral: [\n      \"I have small wrists and still went with the 6X and glad I did.\",\n      \"I can deal with the looks, as Im now retired.\",\n    ],\n  },\n  competitiveness: {\n    positive: [\n      \"Bought this to replace my vivoactive 3.\",\n      \"I like that this watch has so many features, especially those that monitor health like SP02, respiration, sleep, HRV status, stress, and heart rate.\",\n    ],\n    negative: [\n      \"I do not use it for sleep or heartrate monitoring so not sure how accurate they are.\",\n    ],\n    neutral: [\n      \"I've avoided getting a smartwatch for so long due to short battery life on most of them.\",\n    ],\n  },\n  \"packaging/appearance\": {\n    positive: [\"Great cardboard box.\"],\n    negative: [],\n    neutral: [],\n  },\n  shipping: {\n    positive: [],\n    negative: [],\n    neutral: [],\n  },\n};\n\nconst MOCK_RECOMMENDED_ADS = [\n  {\n    name: \"VIVO Electric 60 x 24 inch Stand Up Desk | Black Table Top, Black Frame, Height Adjustable Standing Workstation with Memory Preset Controller (DESK-KIT-1B6B)\",\n    url: \"www.example.com\",\n    price: \"249.99\",\n    currency: \"USD\",\n    grade: \"A\",\n    adjusted_rating: 4.6,\n    sponsored: true,\n    image_blob: new Blob(new Uint8Array(), { type: \"image/jpeg\" }),\n  },\n];\n\nconst Template = ({\n  data,\n  isOffline,\n  isAnalysisInProgress,\n  analysisEvent,\n  productUrl,\n  userReportedAvailable,\n  adsEnabled,\n  adsEnabledByUser,\n  recommendationData,\n  analysisProgress,\n}) => html`\n  <style>\n    main {\n      /**\n        --shopping-header-background and sidebar background-color should\n        come from shopping.page.css, but they are not loaded when\n        viewing the sidebar in Storybook. Hardcode them here\n       */\n      --shopping-header-background: light-dark(#f9f9fb, #2b2a33);\n      background-color: var(--shopping-header-background);\n      width: 320px;\n    }\n  </style>\n\n  <main>\n    <shopping-container\n      .data=${data}\n      ?isOffline=${isOffline}\n      ?isAnalysisInProgress=${isAnalysisInProgress}\n      .analysisEvent=${analysisEvent}\n      productUrl=${ifDefined(productUrl)}\n      ?userReportedAvailable=${userReportedAvailable}\n      ?adsEnabled=${adsEnabled}\n      ?adsEnabledByUser=${adsEnabledByUser}\n      .recommendationData=${recommendationData}\n      analysisProgress=${analysisProgress}\n    >\n    </shopping-container>\n  </main>\n`;\n\nexport const DefaultShoppingContainer = Template.bind({});\nDefaultShoppingContainer.args = {\n  data: {\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n};\n\nexport const NoHighlights = Template.bind({});\nNoHighlights.args = {\n  data: {\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n  },\n};\n\n/**\n * There will be no animation if prefers-reduced-motion is enabled.\n */\nexport const Loading = Template.bind({});\n\nexport const UnanalyzedProduct = Template.bind({});\nUnanalyzedProduct.args = {\n  data: {\n    adjusted_rating: null,\n    grade: null,\n    highlights: null,\n    product_id: null,\n    needs_analysis: true,\n  },\n};\n\nexport const NewAnalysisInProgress = Template.bind({});\nNewAnalysisInProgress.args = {\n  isAnalysisInProgress: true,\n  analysisProgress: 15,\n};\n\nexport const StaleProduct = Template.bind({});\nStaleProduct.args = {\n  data: {\n    product_id: \"ABCD123\",\n    needs_analysis: true,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n};\n\nexport const ReanalysisInProgress = Template.bind({});\nReanalysisInProgress.args = {\n  data: {\n    product_id: \"ABCD123\",\n    needs_analysis: true,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n  isAnalysisInProgress: true,\n  analysisProgress: 15,\n  analysisEvent: {\n    type: \"ReanalysisRequested\",\n    productUrl: \"https://example.com/ABCD123\",\n  },\n  productUrl: \"https://example.com/ABCD123\",\n};\n\n/**\n * When ad functionality is enabled and the user wants the ad\n * component visible.\n */\nexport const AdVisibleByUser = Template.bind({});\nAdVisibleByUser.args = {\n  data: {\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n  adsEnabled: true,\n  adsEnabledByUser: true,\n  recommendationData: MOCK_RECOMMENDED_ADS,\n};\n\n/**\n * When ad functionality is enabled, but the user wants the ad\n * component hidden.\n */\nexport const AdHiddenByUser = Template.bind({});\nAdHiddenByUser.args = {\n  data: {\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n  adsEnabled: true,\n  adsEnabledByUser: false,\n  recommendationData: MOCK_RECOMMENDED_ADS,\n};\n\nexport const NotEnoughReviews = Template.bind({});\nNotEnoughReviews.args = {\n  data: {\n    adjusted_rating: null,\n    grade: null,\n    highlights: null,\n    product_id: \"ABCD123\",\n    needs_analysis: true,\n  },\n};\n\nexport const ProductNotAvailable = Template.bind({});\nProductNotAvailable.args = {\n  data: {\n    deleted_product: true,\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n};\n\nexport const ThanksForReporting = Template.bind({});\nThanksForReporting.args = {\n  data: {\n    deleted_product: true,\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n  userReportedAvailable: true,\n};\n\nexport const UnavailableProductReported = Template.bind({});\nUnavailableProductReported.args = {\n  data: {\n    deleted_product: true,\n    deleted_product_reported: true,\n    product_id: \"ABCD123\",\n    needs_analysis: false,\n    adjusted_rating: 5,\n    grade: \"B\",\n    highlights: MOCK_HIGHLIGHTS,\n  },\n};\n\nexport const PageNotSupported = Template.bind({});\nPageNotSupported.args = {\n  data: {\n    product_id: null,\n    adjusted_rating: null,\n    grade: null,\n    page_not_supported: true,\n  },\n};\n\nexport const GenericError = Template.bind({});\nGenericError.args = {\n  data: {\n    status: 422,\n    error: \"Unprocessable entity\",\n  },\n};\n\nexport const Offline = Template.bind({});\nOffline.args = {\n  isOffline: true,\n};\n"],"names":[],"sourceRoot":""}