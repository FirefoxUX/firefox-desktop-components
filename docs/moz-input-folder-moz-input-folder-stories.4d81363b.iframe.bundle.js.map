{"version":3,"file":"moz-input-folder-moz-input-folder-stories.4d81363b.iframe.bundle.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAKA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC1IA;AACA;AACA;AACA;;AAEA;AACA;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAIA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzKA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///../../../toolkit/content/widgets/moz-input-folder/moz-input-folder.stories.mjs","webpack:///../../../toolkit/content/widgets/moz-input-folder/moz-input-folder.mjs","webpack:///../../../toolkit/content/widgets/moz-input-text/moz-input-text.mjs"],"sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined } from \"../vendor/lit.all.mjs\";\nimport \"./moz-input-folder.mjs\";\n\nexport default {\n  title: \"UI Widgets/Input Folder\",\n  component: \"moz-input-folder\",\n  argTypes: {\n    l10nId: {\n      options: [\n        \"moz-input-folder-label\",\n        \"moz-input-folder-placeholder\",\n        \"moz-input-folder-description\",\n      ],\n      control: { type: \"select\" },\n    },\n  },\n  parameters: {\n    status: \"in-development\",\n    handles: [\"change\", \"click\"],\n    fluent: `\nmoz-input-folder-label =\n  .label = Save files to\nmoz-input-folder-placeholder =\n  .label = Save files to\n  .placeholder = Select folder\nmoz-input-folder-description =\n  .label = Save files to\n  .description = Description text\n  .placeholder = Select folder\n    `,\n  },\n};\n\nconst Template = ({\n  name,\n  value,\n  iconSrc,\n  disabled,\n  l10nId,\n  description,\n  supportPage,\n  hasSlottedDescription,\n  hasSlottedSupportLink,\n}) => html`\n  <div style=\"width: 400px;\">\n    <moz-input-folder\n      name=${name}\n      value=${ifDefined(value || null)}\n      iconsrc=${ifDefined(iconSrc || null)}\n      ?disabled=${disabled}\n      data-l10n-id=${l10nId}\n      support-page=${ifDefined(supportPage || null)}\n      @click=${{\n        handleEvent: e => {\n          if (e.composedPath().some(el => el.localName == \"moz-button\")) {\n            e.stopPropagation();\n            alert(\"This would open the file picker\");\n          }\n        },\n        capture: true,\n      }}\n    >\n      ${hasSlottedDescription\n        ? html`<div slot=\"description\">${description}</div>`\n        : \"\"}\n      ${hasSlottedSupportLink\n        ? html`<a slot=\"support-link\" href=\"www.example.com\">Click me!</a>`\n        : \"\"}\n    </moz-input-folder>\n  </div>\n`;\n\nexport const Default = Template.bind({});\nDefault.args = {\n  name: \"example-moz-input-folder\",\n  value: \"\",\n  iconSrc: \"\",\n  disabled: false,\n  l10nId: \"moz-input-folder-label\",\n  supportPage: \"\",\n  hasSlottedDescription: false,\n  hasSlottedSupportLink: false,\n};\n\nexport const WithValue = Template.bind({});\nWithValue.args = {\n  ...Default.args,\n  value: \"/User/Downloads\",\n};\n\nexport const WithPlaceholder = Template.bind({});\nWithPlaceholder.args = {\n  ...Default.args,\n  l10nId: \"moz-input-folder-placeholder\",\n};\n\nexport const WithIcon = Template.bind({});\nWithIcon.args = {\n  ...Default.args,\n  iconSrc: \"chrome://global/skin/icons/highlights.svg\",\n};\n\nexport const withDescription = Template.bind({});\nwithDescription.args = {\n  ...Default.args,\n  l10nId: \"moz-input-folder-description\",\n};\n\nexport const WithSlottedDescription = Template.bind({});\nWithSlottedDescription.args = {\n  ...Default.args,\n  description: \"This is a custom slotted description.\",\n  hasSlottedDescription: true,\n};\n\nexport const Disabled = Template.bind({});\nDisabled.args = {\n  ...Default.args,\n  l10nId: \"moz-input-folder-description\",\n  disabled: true,\n};\n\nexport const WithSupportLink = Template.bind({});\nWithSupportLink.args = {\n  ...Default.args,\n  supportPage: \"support-page\",\n  l10nId: \"moz-input-folder-description\",\n};\n\nexport const WithSlottedSupportLink = Template.bind({});\nWithSlottedSupportLink.args = {\n  ...Default.args,\n  hasSlottedSupportLink: true,\n  l10nId: \"moz-input-folder-description\",\n};\n","import __chrome_styles_loader__mozinputfolderStyles from \"toolkit/content/widgets/moz-input-folder/moz-input-folder.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, classMap, styleMap } from \"../vendor/lit.all.mjs\";\nimport MozInputText from \"chrome://global/content/elements/moz-input-text.mjs\";\n\nwindow.MozXULElement?.insertFTLIfNeeded(\"toolkit/global/mozInputFolder.ftl\");\n\n/**\n * An input folder custom element.\n *\n * @tagname moz-input-folder\n *\n * @property {string} label - The text of the label element\n * @property {string} name - The name of the input control\n * @property {string} value - The path to the selected folder\n * @property {boolean} disabled - The disabled state of the component\n * @property {string} iconSrc - The src for an optional icon in the label\n * @property {string} description - The text for the description element that helps describe the input control\n * @property {string} supportPage - Name of the SUMO support page to link to.\n * @property {string} placeholder - Text to display when the input has no value.\n * @property {string} displayValue - The value of the input control if it's different from the component value.\n * @property {string} dialogTitle - Text to display as a file picker dialog title.\n * @property {object} folder - The file object that represents the selected folder.\n */\n\nexport default class MozInputFolder extends MozInputText {\n  #folder;\n\n  static properties = {\n    displayValue: { type: String },\n    dialogTitle: { type: String, fluent: true },\n    _inputIconSrc: { type: String, state: true },\n  };\n\n  static queries = {\n    chooseFolderButtonEl: \"#choose-folder-button\",\n  };\n\n  constructor() {\n    super();\n    this.readonly = true;\n    this.displayValue = \"\";\n    this.dialogTitle = \"\";\n    this._inputIconSrc = \"\";\n    this.#folder = null;\n  }\n\n  willUpdate(changedProperties) {\n    super.willUpdate(changedProperties);\n\n    if (changedProperties.has(\"readonly\")) {\n      this.readonly = true;\n    }\n    if (changedProperties.has(\"value\")) {\n      if (this.value == \"\") {\n        this.#folder = null;\n        this._inputIconSrc = \"\";\n      } else if (!this.#folder || this.value != this.#folder.path) {\n        let currentValue = this.value;\n        this.getFolderFromPath(this.value).then(folder => {\n          if (this.value === currentValue) {\n            this.#folder = folder;\n            this._inputIconSrc = this.getInputIconSrc(this.#folder);\n          }\n        });\n      } else {\n        this._inputIconSrc = this.getInputIconSrc(this.#folder);\n      }\n    }\n  }\n\n  get folder() {\n    return this.#folder;\n  }\n\n  async getFolderFromPath(path) {\n    let folder = null;\n    try {\n      folder = await IOUtils.getDirectory(path);\n    } catch (e) {\n      //Not a valid path\n      console.error(\n        \"The error occurred while attempting to get directory from the moz-input-folder value\"\n      );\n    }\n\n    return folder;\n  }\n\n  getInputIconSrc(folder) {\n    if (!folder) {\n      return \"\";\n    }\n\n    let fph = Services.io\n      .getProtocolHandler(\"file\")\n      .QueryInterface(Ci.nsIFileProtocolHandler);\n    let iconUrlSpec = fph.getURLSpecFromDir(folder);\n    let inputIconSrc = \"moz-icon://\" + iconUrlSpec + \"?size=16\";\n    return inputIconSrc;\n  }\n\n  async openFolderPicker() {\n    let folderPicker = Cc[\"@mozilla.org/filepicker;1\"].createInstance(\n      Ci.nsIFilePicker\n    );\n    let mode = Ci.nsIFilePicker.modeGetFolder;\n    folderPicker.init(window.browsingContext, this.dialogTitle, mode);\n    folderPicker.appendFilters(Ci.nsIFilePicker.filterAll);\n\n    if (this.#folder) {\n      folderPicker.displayDirectory = this.#folder;\n    }\n\n    let result = await new Promise(resolve => folderPicker.open(resolve));\n    if (\n      result != Ci.nsIFilePicker.returnOK ||\n      this.value == folderPicker.file.path\n    ) {\n      if (Cu.isInAutomation) {\n        // Dispatch a test-only event so we can tell that the dialog is closing.\n        this.dispatchEvent(new CustomEvent(\"moz-input-folder-picker-close\"));\n      }\n\n      return;\n    }\n\n    this.#folder = folderPicker.file;\n    this.value = this.#folder.path;\n\n    this.dispatchEvent(new Event(\"input\", { bubbles: true }));\n    this.dispatchEvent(new Event(\"change\", { bubbles: true }));\n  }\n\n  inputStylesTemplate() {\n    return html`<link\n      rel=\"stylesheet\"\n      href=\"${__chrome_styles_loader__mozinputfolderStyles}\"\n    />`;\n  }\n\n  inputTemplate() {\n    let inputValue = this.displayValue || this.value;\n    let classes, styles;\n    if (this._inputIconSrc) {\n      classes = classMap({\n        \"with-icon\": true,\n      });\n      styles = styleMap({\n        \"--input-background-icon\": `url(${this._inputIconSrc})`,\n      });\n    }\n\n    return html`\n      <div class=\"container\">\n        ${super.inputTemplate({ classes, styles, inputValue })}\n        <moz-button\n          id=\"choose-folder-button\"\n          data-l10n-id=\"choose-folder-button\"\n          ?disabled=${this.disabled || this.parentDisabled}\n          @click=${this.openFolderPicker}\n        ></moz-button>\n      </div>\n    `;\n  }\n}\ncustomElements.define(\"moz-input-folder\", MozInputFolder);\n","import __chrome_styles_loader__mozinputtextStyles from \"toolkit/content/widgets/moz-input-text/moz-input-text.css\";\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { html, ifDefined } from \"../vendor/lit.all.mjs\";\nimport { MozBaseInputElement } from \"../lit-utils.mjs\";\n\n/**\n * A text input custom element.\n *\n * @tagname moz-input-text\n * @property {string} label - The text of the label element\n * @property {string} name - The name of the input control\n * @property {string} value - The value of the input control\n * @property {boolean} disabled - The disabled state of the input control\n * @property {boolean} readonly - The readonly state of the input control\n * @property {string} iconSrc - The src for an optional icon\n * @property {string} description - The text for the description element that helps describe the input control\n * @property {string} supportPage - Name of the SUMO support page to link to.\n * @property {string} placeholder - Text to display when the input has no value.\n */\nexport default class MozInputText extends MozBaseInputElement {\n  static properties = {\n    placeholder: { type: String, fluent: true },\n    readonly: { type: Boolean, mapped: true },\n  };\n  static inputLayout = \"block\";\n\n  constructor() {\n    super();\n    this.value = \"\";\n    this.readonly = false;\n  }\n\n  inputStylesTemplate() {\n    return html`<link\n      rel=\"stylesheet\"\n      href=\"${__chrome_styles_loader__mozinputtextStyles}\"\n    />`;\n  }\n\n  handleInput(e) {\n    this.value = e.target.value;\n  }\n\n  inputTemplate(options = {}) {\n    let { type = \"text\", classes, styles, inputValue } = options;\n\n    return html`\n      <input\n        id=\"input\"\n        type=${type}\n        class=${ifDefined(classes)}\n        style=${ifDefined(styles)}\n        name=${this.name}\n        value=${inputValue || this.value}\n        ?disabled=${this.disabled || this.parentDisabled}\n        ?readonly=${this.readonly}\n        accesskey=${ifDefined(this.accessKey)}\n        placeholder=${ifDefined(this.placeholder)}\n        aria-describedby=\"description\"\n        @input=${this.handleInput}\n        @change=${this.redispatchEvent}\n      />\n    `;\n  }\n}\ncustomElements.define(\"moz-input-text\", MozInputText);\n"],"names":[],"sourceRoot":""}